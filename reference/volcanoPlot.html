<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1.0"><title>Volcano plot for NULISAseq differential abundance test — volcanoPlot • NULISAseqR</title><!-- favicons --><link rel="icon" type="image/png" sizes="48x48" href="../favicon-48x48.png"><link rel="icon" type="”image/svg+xml”" href="../favicon.svg"><link rel="apple-touch-icon" sizes="180x180" href="../apple-touch-icon.png"><link rel="icon" sizes="any" href="../favicon.ico"><link rel="manifest" href="../site.webmanifest"><!-- jquery --><script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.7.1/jquery.min.js" integrity="sha512-v2CJ7UaYy4JwqLDIrZUI/4hqeoQieOmAZNXBeQyjo21dadnwR+8ZaIJVT8EE2iyI61OV8e6M8PP2/4hpQINQ/g==" crossorigin="anonymous" referrerpolicy="no-referrer"></script><!-- Bootstrap --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/css/bootstrap.min.css" integrity="sha256-bZLfwXAP04zRMK2BjiO8iu9pf4FbLqX6zitd+tIvLhE=" crossorigin="anonymous"><script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/js/bootstrap.min.js" integrity="sha256-nuL8/2cJ5NDSSwnKD8VqreErSWHtnEP9E7AySL+1ev4=" crossorigin="anonymous"></script><!-- bootstrap-toc --><link rel="stylesheet" href="../bootstrap-toc.css"><script src="../bootstrap-toc.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous"><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous"><!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- pkgdown --><link href="../pkgdown.css" rel="stylesheet"><script src="../pkgdown.js"></script><meta property="og:title" content="Volcano plot for NULISAseq differential abundance test — volcanoPlot"><meta property="og:description" content="Draws a volcano plot for a set of coefficients and p-values. Uses ggplot
for plotting and ggrepel package for labels. By default, plot labeling
assumes FDR-corrected p-values. Can plot both unadjusted and FDR-adjusted
p-values with different colors."><meta property="og:image" content="https://nulisaseqr.alamarbio.com/logo.png"><!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]--></head><body data-spy="scroll" data-target="#toc">


    <div class="container template-reference-topic">
      <header><div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">NULISAseqR</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="">1.4.0</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav"><li>
  <a href="https://nulisaseqr.alamarbio.com/user-guide">User Guide</a>
</li>
<li>
  <a href="../reference/index.html">Reference</a>
</li>
<li>
  <a href="../news/index.html">News</a>
</li>
      </ul><ul class="nav navbar-nav navbar-right"><li>
  <a href="https://github.com/Alamar-Biosciences/NULISAseqR" class="external-link">
    <span class="fab fa-github fa-lg"></span>

  </a>
</li>
      </ul></div><!--/.nav-collapse -->
  </div><!--/.container -->
</div><!--/.navbar -->



      </header><div class="row">
  <div class="col-md-9 contents">
    <div class="page-header">
    <h1>Volcano plot for NULISAseq differential abundance test</h1>
    <small class="dont-index">Source: <a href="https://github.com/Alamar-Biosciences/NULISAseqR/blob/HEAD/R/volcanoPlot.R" class="external-link"><code>R/volcanoPlot.R</code></a></small>
    <div class="hidden name"><code>volcanoPlot.Rd</code></div>
    </div>

    <div class="ref-description">
    <p>Draws a volcano plot for a set of coefficients and p-values. Uses ggplot
for plotting and ggrepel package for labels. By default, plot labeling
assumes FDR-corrected p-values. Can plot both unadjusted and FDR-adjusted
p-values with different colors.</p>
    </div>

    <div id="ref-usage">
    <div class="sourceCode"><pre class="sourceCode r"><code><span><span class="fu">volcanoPlot</span><span class="op">(</span></span>
<span>  <span class="va">coefs</span>,</span>
<span>  <span class="va">p_vals</span>,</span>
<span>  <span class="va">target_labels</span>,</span>
<span>  title <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  xlabel <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/expression.html" class="external-link">expression</a></span><span class="op">(</span><span class="st">"log"</span><span class="op">[</span><span class="fl">2</span><span class="op">]</span> <span class="op">*</span> <span class="st">"(fold change)"</span><span class="op">)</span>,</span>
<span>  ylabel <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/expression.html" class="external-link">expression</a></span><span class="op">(</span><span class="st">"-log"</span><span class="op">[</span><span class="fl">10</span><span class="op">]</span> <span class="op">*</span> <span class="st">"(FDR-adjusted p-value)"</span><span class="op">)</span>,</span>
<span>  xlimits <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  ylimits <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  sig_threshold <span class="op">=</span> <span class="fl">0.05</span>,</span>
<span>  sig_label <span class="op">=</span> <span class="st">"FDR = 5%"</span>,</span>
<span>  label_all_targets <span class="op">=</span> <span class="cn">FALSE</span>,</span>
<span>  upper_log2FC_threshold <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  lower_log2FC_threshold <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  target_labels_off <span class="op">=</span> <span class="cn">FALSE</span>,</span>
<span>  target_label_colors <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  target_point_colors <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  target_label_size <span class="op">=</span> <span class="fl">2</span>,</span>
<span>  target_label_segment_color <span class="op">=</span> <span class="st">"grey"</span>,</span>
<span>  max.overlaps <span class="op">=</span> <span class="cn">Inf</span>,</span>
<span>  force <span class="op">=</span> <span class="fl">1</span>,</span>
<span>  force_pull <span class="op">=</span> <span class="fl">1</span>,</span>
<span>  plot_title_font_size <span class="op">=</span> <span class="fl">14</span>,</span>
<span>  axis_label_font_size <span class="op">=</span> <span class="fl">12</span>,</span>
<span>  tick_label_font_size <span class="op">=</span> <span class="fl">12</span>,</span>
<span>  plot_aspect_ratio <span class="op">=</span> <span class="fl">1</span>,</span>
<span>  log_y <span class="op">=</span> <span class="cn">TRUE</span>,</span>
<span>  output_dir <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  plot_name <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  plot_width <span class="op">=</span> <span class="fl">7</span>,</span>
<span>  plot_height <span class="op">=</span> <span class="fl">7</span></span>
<span><span class="op">)</span></span></code></pre></div>
    </div>

    <div id="arguments">
    <h2>Arguments</h2>


<dl><dt id="arg-coefs">coefs<a class="anchor" aria-label="anchor" href="#arg-coefs"></a></dt>
<dd><p>Vector of coefficients.</p></dd>


<dt id="arg-p-vals">p_vals<a class="anchor" aria-label="anchor" href="#arg-p-vals"></a></dt>
<dd><p>Vector of p-values OR a named list with 'unadj' and 'fdr' p-values.
If a list, the y-axis will plot unadjusted p-values with light colors for unadjusted
significant targets and darker colors for FDR significant targets.</p></dd>


<dt id="arg-target-labels">target_labels<a class="anchor" aria-label="anchor" href="#arg-target-labels"></a></dt>
<dd><p>Vector of target names.</p></dd>


<dt id="arg-title">title<a class="anchor" aria-label="anchor" href="#arg-title"></a></dt>
<dd><p>Plot title.</p></dd>


<dt id="arg-xlabel">xlabel<a class="anchor" aria-label="anchor" href="#arg-xlabel"></a></dt>
<dd><p>X axis label.</p></dd>


<dt id="arg-ylabel">ylabel<a class="anchor" aria-label="anchor" href="#arg-ylabel"></a></dt>
<dd><p>Y axis label; defaults to <code>expression('-log'[10]*'(FDR-adjusted p-value)')</code>.
Automatically overridden to show unadjusted p-value when in dual mode.</p></dd>


<dt id="arg-xlimits">xlimits<a class="anchor" aria-label="anchor" href="#arg-xlimits"></a></dt>
<dd><p>X axis limits</p></dd>


<dt id="arg-ylimits">ylimits<a class="anchor" aria-label="anchor" href="#arg-ylimits"></a></dt>
<dd><p>Y axis limits</p></dd>


<dt id="arg-sig-threshold">sig_threshold<a class="anchor" aria-label="anchor" href="#arg-sig-threshold"></a></dt>
<dd><p>P-value significance threshold OR a named list with 'unadj' and
'fdr' thresholds. Must match the structure of p_vals.</p></dd>


<dt id="arg-sig-label">sig_label<a class="anchor" aria-label="anchor" href="#arg-sig-label"></a></dt>
<dd><p>Label to mark significance threshold on plot; defaults to <code>"FDR = 5%"</code>.
Automatically overridden to <code>"Unadj = X%"</code> when in dual mode (where X is the unadj threshold percentage).
Always a single string.</p></dd>


<dt id="arg-label-all-targets">label_all_targets<a class="anchor" aria-label="anchor" href="#arg-label-all-targets"></a></dt>
<dd><p>Logical TRUE or FALSE.
Should all targets be labelled? Default is FALSE
and will only label significant targets.</p></dd>


<dt id="arg-upper-log-fc-threshold">upper_log2FC_threshold<a class="anchor" aria-label="anchor" href="#arg-upper-log-fc-threshold"></a></dt>
<dd><p>Coefficients/fold change upper threshold cutoff for
labeling insignificant targets. Insignificant targets above the upper threshold will be labelled.
Default is <code>NULL</code></p></dd>


<dt id="arg-lower-log-fc-threshold">lower_log2FC_threshold<a class="anchor" aria-label="anchor" href="#arg-lower-log-fc-threshold"></a></dt>
<dd><p>Coefficients/fold change lower threshold cutoff for
labeling insignificant targets. Insignificant targets below the lower threshold will be labelled.
Default is <code>NULL</code>.</p></dd>


<dt id="arg-target-labels-off">target_labels_off<a class="anchor" aria-label="anchor" href="#arg-target-labels-off"></a></dt>
<dd><p>Logical TRUE or FALSE. Should no targets be labelled?
Default is <code>FALSE</code>.</p></dd>


<dt id="arg-target-label-colors">target_label_colors<a class="anchor" aria-label="anchor" href="#arg-target-label-colors"></a></dt>
<dd><p>A vector of the same length as number of targets
and same order as targets with colors for the target labels. Default is to
color upregulated target labels red and downregulated target labels blue.</p></dd>


<dt id="arg-target-point-colors">target_point_colors<a class="anchor" aria-label="anchor" href="#arg-target-point-colors"></a></dt>
<dd><p>A vector of the same length as number of targets
and same order as targets with colors for the points. Default is to
make significant upregulated target points red, significant downregulated
target points blue, and nonsignificant target points grey.</p></dd>


<dt id="arg-target-label-size">target_label_size<a class="anchor" aria-label="anchor" href="#arg-target-label-size"></a></dt>
<dd><p>Font size of target labels.</p></dd>


<dt id="arg-target-label-segment-color">target_label_segment_color<a class="anchor" aria-label="anchor" href="#arg-target-label-segment-color"></a></dt>
<dd><p>Color of line segments for target labels.
Can be a single value or a vector same length as number of targets.</p></dd>


<dt id="arg-max-overlaps">max.overlaps<a class="anchor" aria-label="anchor" href="#arg-max-overlaps"></a></dt>
<dd><p>Passed to <code><a href="https://ggrepel.slowkow.com/reference/geom_text_repel.html" class="external-link">ggrepel::geom_text_repel</a></code>. Integer which determines how many targets
will have labels. "Inf" (default) labels all targets.</p></dd>


<dt id="arg-force">force<a class="anchor" aria-label="anchor" href="#arg-force"></a></dt>
<dd><p>Passed to <code><a href="https://ggrepel.slowkow.com/reference/geom_text_repel.html" class="external-link">ggrepel::geom_text_repel</a></code>. Force of repulsion between overlapping text labels. Defaults to 1.</p></dd>


<dt id="arg-force-pull">force_pull<a class="anchor" aria-label="anchor" href="#arg-force-pull"></a></dt>
<dd><p>Passed to <code><a href="https://ggrepel.slowkow.com/reference/geom_text_repel.html" class="external-link">ggrepel::geom_text_repel</a></code>. Force of attraction between a text label and its corresponding data point. Defaults to 1.</p></dd>


<dt id="arg-plot-title-font-size">plot_title_font_size<a class="anchor" aria-label="anchor" href="#arg-plot-title-font-size"></a></dt>
<dd><p>Font size of plot title.</p></dd>


<dt id="arg-axis-label-font-size">axis_label_font_size<a class="anchor" aria-label="anchor" href="#arg-axis-label-font-size"></a></dt>
<dd><p>Font size of axis title.</p></dd>


<dt id="arg-tick-label-font-size">tick_label_font_size<a class="anchor" aria-label="anchor" href="#arg-tick-label-font-size"></a></dt>
<dd><p>Font size of axis tick marks.</p></dd>


<dt id="arg-plot-aspect-ratio">plot_aspect_ratio<a class="anchor" aria-label="anchor" href="#arg-plot-aspect-ratio"></a></dt>
<dd><p>Aspect ratio for plot. Default is 1 (square plot).</p></dd>


<dt id="arg-log-y">log_y<a class="anchor" aria-label="anchor" href="#arg-log-y"></a></dt>
<dd><p>Logical <code>TRUE</code> (default) or <code>FALSE</code>. Should y-axis be
-log10 transformed? (<code>TRUE</code> recommended for plotting p-values.)</p></dd>


<dt id="arg-output-dir">output_dir<a class="anchor" aria-label="anchor" href="#arg-output-dir"></a></dt>
<dd><p>Directory path where plot should be saved; defaults to <code>NULL</code>
(plot not saved to file).</p></dd>


<dt id="arg-plot-name">plot_name<a class="anchor" aria-label="anchor" href="#arg-plot-name"></a></dt>
<dd><p>File name for saved plot including extension (.pdf, .png, .jpg, .svg);
defaults to <code>NULL</code>. If <code>output_dir</code> is specified but <code>plot_name</code> is <code>NULL</code>,
the plot will be saved as "volcano_plot_YYYYMMDD.pdf" with current date.</p></dd>


<dt id="arg-plot-width">plot_width<a class="anchor" aria-label="anchor" href="#arg-plot-width"></a></dt>
<dd><p>Numeric value for the width of the saved plot in inches; defaults to 7.</p></dd>


<dt id="arg-plot-height">plot_height<a class="anchor" aria-label="anchor" href="#arg-plot-height"></a></dt>
<dd><p>Numeric value for the height of the saved plot in inches; defaults to 7.</p></dd>

</dl></div>
    <div id="value">
    <h2>Value</h2>
    <p>Outputs a ggplot object. If <code>output_dir</code> is specified, also saves the plot
in the specified format (PDF, PNG, JPG, or SVG based on file extension in <code>plot_name</code>).</p>
    </div>

  </div>
  <div class="col-md-3 hidden-xs hidden-sm" id="pkgdown-sidebar">
    <nav id="toc" data-toggle="toc" class="sticky-top"><h2 data-toc-skip>Contents</h2>
    </nav></div>
</div>


      <footer><div class="copyright">
  <p></p><p>Developed by Alamar Biosciences Bioinformatics Team.</p>
</div>

<div class="pkgdown">
  <p></p><p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.2.0.</p>
</div>

      </footer></div>






  </body></html>

