% Generated by roxygen2: do not edit by hand
% Please edit documentation in R/sampleQCplot.R
\name{sampleQCplot}
\alias{sampleQCplot}
\title{Creates Plots Showing Sample-Specific Quality Control Metrics}
\usage{
sampleQCplot(
  runs,
  qc_metric = "Detectability",
  plateIDs = NULL,
  output_dir = NULL,
  plot_name = NULL,
  plot_title = NULL,
  plot_width = ifelse(qc_metric == "all", 8, 14),
  plot_height = ifelse(qc_metric == "all", 6, 7),
  label_cex = 0.45,
  point_cex = 0.75,
  legend_cex = 0.75,
  sample_subset_list = NULL,
  target_subset_list = NULL,
  sample_exclude_list = NULL,
  target_exclude_list = NULL
)
}
\arguments{
\item{runs}{A named list of run data output from \code{loadNULISAseq()} function 
or a list of these outputs for multiple runs.}

\item{qc_metric}{The QC metric to plot (default: "Detectability"; select other QC metrics: "IC Reads", "Reads", "IC Median", "all" (showing all 4 metrics)).}

\item{plateIDs}{Optional vector of plate names. (default: extract from runs).}

\item{output_dir}{Directory to save PDF files (NULL for no saving).}

\item{plot_name}{Optional name for the plot file (default: NULL).}

\item{plot_title}{Optional title for the plot (default: NULL).}

\item{plot_width}{PDF width in inches (default: 14 for single QC metric plot, 8 for all four QC metric plots).}

\item{plot_height}{PDF height in inches (default: 7 for single QC metric plot, 6 for all four QC metric plots).}

\item{label_cex}{Text size for labels (default: 0.45).}

\item{point_cex}{Point size (default: 0.75).}

\item{legend_cex}{Legend text size (default: 0.75).}

\item{sample_subset_list}{Optional list of sample subsets for each plate. Can be either:
\itemize{
  \item{A list of character vectors - each vector contains sample names to include for the corresponding plate 
        (e.g., `list(c('A_01_C001 P3', 'A_02_C044 P1'), c('A_01_C040 P1'))` for two plates)}
  \item{A single character vector - only subsets samples from the first plate}
}
Note: Control samples (IPC, NC, SC, Bridge) are always included regardless of subsetting.
(default: NULL)}

\item{target_subset_list}{Optional list of target subsets for each plate. Can be either:
\itemize{
  \item{A list of character vectors - each vector contains target names to include for the corresponding plate}
  \item{A single character vector - only subsets targets from the first plate}
}
(default: NULL)}

\item{sample_exclude_list}{Optional list of samples to exclude for each plate. Can be either:
\itemize{
  \item{A list of character vectors - each vector contains sample names to exclude from the corresponding plate}
  \item{A single character vector - only excludes samples from the first plate}
}
Note: Control samples (IPC, NC, SC, Bridge) are never excluded.
(default: NULL)}

\item{target_exclude_list}{Optional list of targets to exclude for each plate. Can be either:
\itemize{
  \item{A list of character vectors - each vector contains target names to exclude from the corresponding plate}
  \item{A single character vector - only excludes targets from the first plate}
}
(default: NULL)}
}
\value{
A list of plot data and saved PDF files in the specified output directory.
}
\description{
This function generates QC plots for the following metrics:
\describe{
  \item{Detectability}{Percentage of targets with reads above the Limit of Detection (LOD). 
    Minimum thresholds vary by sample type. 
    \itemize{
      \item{Plasma: 90\%}
      \item{Serum: 90\%}
      \item{CSF: 70\%}
      \item{Urine: 65\%}
      \item{Cell culture: 30\%}
      \item{NHP plasma: 55\%}
      \item{NHP CSF: 35\%}
      \item{Dried blood spot: 75\%}
      \item{Control: 90\%}
      \item{Other: 0\%}
    }
  }
  \item{IC Reads}{Number of Internal Control (IC) reads within a sample. Minimum threshold: 1,000 reads}
  \item{Reads}{Total number of reads within a sample. Minimum threshold: 500,000 reads}
  \item{IC Median}{Sample IC reads relative to the plate median. Acceptable range: within +/-40\% of plate median}
}
}
\details{
For "all" option, plots all four QC metrics in a consolidated view.
}
