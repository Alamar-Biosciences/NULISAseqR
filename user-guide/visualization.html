<!DOCTYPE html>
<html lang="" xml:lang="">
<head>

  <meta charset="utf-8" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  <title>Chapter 3 Visualization | NULISAseqR User Guide</title>
  <meta name="description" content="A comprehensive guide to analyzing NULISAseq proteomic data with the NULISAseqR R package" />
  <meta name="generator" content="bookdown 0.46 and GitBook 2.6.7" />

  <meta property="og:title" content="Chapter 3 Visualization | NULISAseqR User Guide" />
  <meta property="og:type" content="book" />
  
  <meta property="og:description" content="A comprehensive guide to analyzing NULISAseq proteomic data with the NULISAseqR R package" />
  <meta name="github-repo" content="Alamar-Biosciences/NULISAseqR" />

  <meta name="twitter:card" content="summary" />
  <meta name="twitter:title" content="Chapter 3 Visualization | NULISAseqR User Guide" />
  
  <meta name="twitter:description" content="A comprehensive guide to analyzing NULISAseq proteomic data with the NULISAseqR R package" />
  




  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <meta name="apple-mobile-web-app-capable" content="yes" />
  <meta name="apple-mobile-web-app-status-bar-style" content="black" />
  
  
<link rel="prev" href="quality-control.html"/>
<link rel="next" href="differential-abundance-analysis.html"/>
<script src="libs/jquery-3.6.1/jquery-3.6.1.min.js"></script>
<script src="https://cdn.jsdelivr.net/npm/fuse.js@6.4.6/dist/fuse.min.js"></script>
<link href="libs/gitbook-2.6.7/css/style.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-table.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-bookdown.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-highlight.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-search.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-fontsettings.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-clipboard.css" rel="stylesheet" />








<link href="libs/anchor-sections-1.1.0/anchor-sections.css" rel="stylesheet" />
<link href="libs/anchor-sections-1.1.0/anchor-sections-hash.css" rel="stylesheet" />
<script src="libs/anchor-sections-1.1.0/anchor-sections.js"></script>
<link href="libs/htmltools-fill-0.5.9/fill.css" rel="stylesheet" />
<script src="libs/htmlwidgets-1.6.4/htmlwidgets.js"></script>
<link href="libs/datatables-css-0.0.0/datatables-crosstalk.css" rel="stylesheet" />
<script src="libs/datatables-binding-0.34.0/datatables.js"></script>
<link href="libs/dt-core-1.13.6/css/jquery.dataTables.min.css" rel="stylesheet" />
<link href="libs/dt-core-1.13.6/css/jquery.dataTables.extra.css" rel="stylesheet" />
<script src="libs/dt-core-1.13.6/js/jquery.dataTables.min.js"></script>
<link href="libs/crosstalk-1.2.2/css/crosstalk.min.css" rel="stylesheet" />
<script src="libs/crosstalk-1.2.2/js/crosstalk.min.js"></script>
<link href="libs/table1-1.0/table1_defaults.css" rel="stylesheet" />
<link rel="shortcut icon" href="figures/favicon.png" />


<style type="text/css">
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {  background-color: #f8f8f8; }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
code span.al { color: #ef2929; } /* Alert */
code span.an { color: #8f5902; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #204a87; } /* Attribute */
code span.bn { color: #0000cf; } /* BaseN */
code span.cf { color: #204a87; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4e9a06; } /* Char */
code span.cn { color: #8f5902; } /* Constant */
code span.co { color: #8f5902; font-style: italic; } /* Comment */
code span.cv { color: #8f5902; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #8f5902; font-weight: bold; font-style: italic; } /* Documentation */
code span.dt { color: #204a87; } /* DataType */
code span.dv { color: #0000cf; } /* DecVal */
code span.er { color: #a40000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #0000cf; } /* Float */
code span.fu { color: #204a87; font-weight: bold; } /* Function */
code span.im { } /* Import */
code span.in { color: #8f5902; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #204a87; font-weight: bold; } /* Keyword */
code span.op { color: #ce5c00; font-weight: bold; } /* Operator */
code span.ot { color: #8f5902; } /* Other */
code span.pp { color: #8f5902; font-style: italic; } /* Preprocessor */
code span.sc { color: #ce5c00; font-weight: bold; } /* SpecialChar */
code span.ss { color: #4e9a06; } /* SpecialString */
code span.st { color: #4e9a06; } /* String */
code span.va { color: #000000; } /* Variable */
code span.vs { color: #4e9a06; } /* VerbatimString */
code span.wa { color: #8f5902; font-weight: bold; font-style: italic; } /* Warning */
</style>

<style type="text/css">
  
  div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
</style>

</head>

<body>



  <div class="book without-animation with-summary font-size-2 font-family-1" data-basepath=".">

    <div class="book-summary">
      <nav role="navigation">

<ul class="summary">
<li style="text-align: left; padding: 20px;">
  <a href="https://www.alamarbio.com" target="_blank">
    <img src="figures/alamar_logo.png" style="height:70px;">
  </a>
</li>
<li><a href="./">NULISAseqR User Guide</a></li>

<li class="divider"></li>
<li class="chapter" data-level="" data-path="index.html"><a href="index.html"><i class="fa fa-check"></i>Welcome</a>
<ul>
<li class="chapter" data-level="" data-path="index.html"><a href="index.html#what-is-nulisaseqr"><i class="fa fa-check"></i>What is NULISAseqR?</a></li>
<li class="chapter" data-level="" data-path="index.html"><a href="index.html#installation"><i class="fa fa-check"></i>Installation</a>
<ul>
<li class="chapter" data-level="" data-path="index.html"><a href="index.html#macos-users"><i class="fa fa-check"></i>macOS Users</a></li>
<li class="chapter" data-level="" data-path="index.html"><a href="index.html#windows-users"><i class="fa fa-check"></i>Windows Users</a></li>
<li class="chapter" data-level="" data-path="index.html"><a href="index.html#installation-steps"><i class="fa fa-check"></i>Installation Steps</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="index.html"><a href="index.html#getting-help"><i class="fa fa-check"></i>Getting Help</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="understanding-nulisaseq-data.html"><a href="understanding-nulisaseq-data.html"><i class="fa fa-check"></i>Understanding NULISAseq Data</a>
<ul>
<li class="chapter" data-level="" data-path="understanding-nulisaseq-data.html"><a href="understanding-nulisaseq-data.html#what-is-nulisa-technology"><i class="fa fa-check"></i>What is NULISA™ Technology?</a>
<ul>
<li class="chapter" data-level="" data-path="understanding-nulisaseq-data.html"><a href="understanding-nulisaseq-data.html#technical-workflow"><i class="fa fa-check"></i>Technical Workflow</a></li>
<li class="chapter" data-level="" data-path="understanding-nulisaseq-data.html"><a href="understanding-nulisaseq-data.html#learn-more-about-nulisa-technology"><i class="fa fa-check"></i>Learn More About NULISA™ Technology</a></li>
<li class="chapter" data-level="" data-path="understanding-nulisaseq-data.html"><a href="understanding-nulisaseq-data.html#available-nulisaseq-panels"><i class="fa fa-check"></i>Available NULISAseq Panels</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="understanding-nulisaseq-data.html"><a href="understanding-nulisaseq-data.html#data-normalization"><i class="fa fa-check"></i>Data Normalization</a>
<ul>
<li class="chapter" data-level="" data-path="understanding-nulisaseq-data.html"><a href="understanding-nulisaseq-data.html#raw-data-sequencing-counts"><i class="fa fa-check"></i>Raw Data: Sequencing Counts</a></li>
<li class="chapter" data-level="" data-path="understanding-nulisaseq-data.html"><a href="understanding-nulisaseq-data.html#step-1-internal-control-ic-normalization"><i class="fa fa-check"></i>Step 1: Internal Control (IC) Normalization</a></li>
<li class="chapter" data-level="" data-path="understanding-nulisaseq-data.html"><a href="understanding-nulisaseq-data.html#step-2-inter-plate-control-ipc-normalization"><i class="fa fa-check"></i>Step 2: Inter-Plate Control (IPC) Normalization</a></li>
<li class="chapter" data-level="" data-path="understanding-nulisaseq-data.html"><a href="understanding-nulisaseq-data.html#step-3-log2-transformation"><i class="fa fa-check"></i>Step 3: Log2 Transformation</a></li>
<li class="chapter" data-level="" data-path="understanding-nulisaseq-data.html"><a href="understanding-nulisaseq-data.html#why-log-transform"><i class="fa fa-check"></i>Why Log Transform?</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="understanding-nulisaseq-data.html"><a href="understanding-nulisaseq-data.html#npq-vs-fold-change"><i class="fa fa-check"></i>NPQ vs Fold Change</a>
<ul>
<li class="chapter" data-level="" data-path="understanding-nulisaseq-data.html"><a href="understanding-nulisaseq-data.html#understanding-the-relationship"><i class="fa fa-check"></i>Understanding the Relationship</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="understanding-nulisaseq-data.html"><a href="understanding-nulisaseq-data.html#working-with-npq-values"><i class="fa fa-check"></i>Working with NPQ Values</a>
<ul>
<li class="chapter" data-level="" data-path="understanding-nulisaseq-data.html"><a href="understanding-nulisaseq-data.html#calculating-fold-changes-from-npq"><i class="fa fa-check"></i>Calculating Fold Changes from NPQ</a></li>
<li class="chapter" data-level="" data-path="understanding-nulisaseq-data.html"><a href="understanding-nulisaseq-data.html#calculating-fold-changes-in-target-ratios"><i class="fa fa-check"></i>Calculating Fold Changes in Target Ratios</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="understanding-nulisaseq-data.html"><a href="understanding-nulisaseq-data.html#data-analysis-faq"><i class="fa fa-check"></i>Data Analysis FAQ</a>
<ul>
<li class="chapter" data-level="" data-path="understanding-nulisaseq-data.html"><a href="understanding-nulisaseq-data.html#how-is-the-limit-of-detection-lod-defined-for-nulisaseq-why-do-some-targets-have-lod-of-0"><i class="fa fa-check"></i>1. How is the limit of detection (LOD) defined for NULISAseq? <br> Why do some targets have LOD of 0?</a></li>
<li class="chapter" data-level="" data-path="understanding-nulisaseq-data.html"><a href="understanding-nulisaseq-data.html#should-i-exclude-samples-below-lod"><i class="fa fa-check"></i>2. Should I exclude samples below LOD?</a></li>
<li class="chapter" data-level="" data-path="understanding-nulisaseq-data.html"><a href="understanding-nulisaseq-data.html#how-do-i-calculate-coefficient-of-variation-cv-for-samples"><i class="fa fa-check"></i>3. How do I calculate coefficient of variation (CV) for samples?</a></li>
<li class="chapter" data-level="" data-path="understanding-nulisaseq-data.html"><a href="understanding-nulisaseq-data.html#can-i-compare-data-across-different-runs"><i class="fa fa-check"></i>4. Can I compare data across different runs?</a></li>
<li class="chapter" data-level="" data-path="understanding-nulisaseq-data.html"><a href="understanding-nulisaseq-data.html#how-do-you-assess-correlation-between-npq-and-absolute-quantification-data-from-other-platforms"><i class="fa fa-check"></i>5. How do you assess correlation between NPQ and absolute quantification data from other platforms?</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="1" data-path="data-import.html"><a href="data-import.html"><i class="fa fa-check"></i><b>1</b> Data Import</a>
<ul>
<li class="chapter" data-level="1.1" data-path="data-import.html"><a href="data-import.html#the-importnulisaseq-function"><i class="fa fa-check"></i><b>1.1</b> The <code>importNULISAseq()</code> Function</a></li>
<li class="chapter" data-level="1.2" data-path="data-import.html"><a href="data-import.html#understanding-the-data-structure"><i class="fa fa-check"></i><b>1.2</b> Understanding the Data Structure</a>
<ul>
<li class="chapter" data-level="1.2.1" data-path="data-import.html"><a href="data-import.html#key-components"><i class="fa fa-check"></i><b>1.2.1</b> Key Components</a></li>
<li class="chapter" data-level="1.2.2" data-path="data-import.html"><a href="data-import.html#summary-statistics"><i class="fa fa-check"></i><b>1.2.2</b> Summary Statistics</a></li>
</ul></li>
<li class="chapter" data-level="1.3" data-path="data-import.html"><a href="data-import.html#working-with-your-own-data"><i class="fa fa-check"></i><b>1.3</b> Working with Your Own Data</a></li>
<li class="chapter" data-level="1.4" data-path="data-import.html"><a href="data-import.html#loading-metadata"><i class="fa fa-check"></i><b>1.4</b> Loading Metadata</a>
<ul>
<li class="chapter" data-level="1.4.1" data-path="data-import.html"><a href="data-import.html#metadata-structure"><i class="fa fa-check"></i><b>1.4.1</b> Metadata Structure</a></li>
</ul></li>
<li class="chapter" data-level="1.5" data-path="data-import.html"><a href="data-import.html#merging-data-with-metadata"><i class="fa fa-check"></i><b>1.5</b> Merging Data with Metadata</a>
<ul>
<li class="chapter" data-level="1.5.1" data-path="data-import.html"><a href="data-import.html#understanding-sample-names"><i class="fa fa-check"></i><b>1.5.1</b> Understanding Sample Names</a></li>
<li class="chapter" data-level="1.5.2" data-path="data-import.html"><a href="data-import.html#merging-options"><i class="fa fa-check"></i><b>1.5.2</b> Merging Options</a></li>
</ul></li>
<li class="chapter" data-level="1.6" data-path="data-import.html"><a href="data-import.html#filtering-samples"><i class="fa fa-check"></i><b>1.6</b> Filtering Samples</a></li>
<li class="chapter" data-level="1.7" data-path="data-import.html"><a href="data-import.html#complete-import-workflow"><i class="fa fa-check"></i><b>1.7</b> Complete Import Workflow</a></li>
<li class="chapter" data-level="1.8" data-path="data-import.html"><a href="data-import.html#tips-and-best-practices"><i class="fa fa-check"></i><b>1.8</b> Tips and Best Practices</a></li>
</ul></li>
<li class="chapter" data-level="2" data-path="quality-control.html"><a href="quality-control.html"><i class="fa fa-check"></i><b>2</b> Quality Control</a>
<ul>
<li class="chapter" data-level="2.1" data-path="quality-control.html"><a href="quality-control.html#why-quality-control-matters"><i class="fa fa-check"></i><b>2.1</b> Why Quality Control Matters</a></li>
<li class="chapter" data-level="2.2" data-path="quality-control.html"><a href="quality-control.html#qc-report"><i class="fa fa-check"></i><b>2.2</b> Automated QC Report</a></li>
<li class="chapter" data-level="2.3" data-path="quality-control.html"><a href="quality-control.html#qc-report-structure"><i class="fa fa-check"></i><b>2.3</b> QC Report Structure</a>
<ul>
<li class="chapter" data-level="2.3.1" data-path="quality-control.html"><a href="quality-control.html#plate-layout"><i class="fa fa-check"></i><b>2.3.1</b> Plate Layout</a></li>
<li class="chapter" data-level="2.3.2" data-path="quality-control.html"><a href="quality-control.html#run-summary"><i class="fa fa-check"></i><b>2.3.2</b> Run Summary</a></li>
<li class="chapter" data-level="" data-path="quality-control.html"><a href="quality-control.html#quality-control-metrics"><i class="fa fa-check"></i>Quality Control Metrics</a></li>
<li class="chapter" data-level="2.3.3" data-path="quality-control.html"><a href="quality-control.html#platerun-qc"><i class="fa fa-check"></i><b>2.3.3</b> Plate/Run QC</a></li>
<li class="chapter" data-level="2.3.4" data-path="quality-control.html"><a href="quality-control.html#sample-qc"><i class="fa fa-check"></i><b>2.3.4</b> Sample QC</a></li>
<li class="chapter" data-level="2.3.5" data-path="quality-control.html"><a href="quality-control.html#target-qc"><i class="fa fa-check"></i><b>2.3.5</b> Target QC</a></li>
<li class="chapter" data-level="2.3.6" data-path="quality-control.html"><a href="quality-control.html#coefficient-of-variation-cv"><i class="fa fa-check"></i><b>2.3.6</b> Coefficient of Variation (CV)</a></li>
<li class="chapter" data-level="2.3.7" data-path="quality-control.html"><a href="quality-control.html#batch-effect-assessment"><i class="fa fa-check"></i><b>2.3.7</b> Batch Effect Assessment</a></li>
</ul></li>
<li class="chapter" data-level="2.4" data-path="quality-control.html"><a href="quality-control.html#qc-thresholds-summary"><i class="fa fa-check"></i><b>2.4</b> Summary of QC Thresholds</a></li>
<li class="chapter" data-level="2.5" data-path="quality-control.html"><a href="quality-control.html#manual-qc-checks"><i class="fa fa-check"></i><b>2.5</b> Manual QC Checks</a>
<ul>
<li class="chapter" data-level="2.5.1" data-path="quality-control.html"><a href="quality-control.html#check-for-missing-data"><i class="fa fa-check"></i><b>2.5.1</b> Check for Missing Data</a></li>
<li class="chapter" data-level="2.5.2" data-path="quality-control.html"><a href="quality-control.html#low-detectability-targets"><i class="fa fa-check"></i><b>2.5.2</b> Low Detectability Targets</a></li>
<li class="chapter" data-level="2.5.3" data-path="quality-control.html"><a href="quality-control.html#calculate-targets-detectability-by-subgroups"><i class="fa fa-check"></i><b>2.5.3</b> Calculate Targets Detectability by Subgroups</a></li>
<li class="chapter" data-level="2.5.4" data-path="quality-control.html"><a href="quality-control.html#batch-effect-correction"><i class="fa fa-check"></i><b>2.5.4</b> Batch Effect Correction</a></li>
</ul></li>
<li class="chapter" data-level="2.6" data-path="quality-control.html"><a href="quality-control.html#qc-best-practices"><i class="fa fa-check"></i><b>2.6</b> Best Practices</a>
<ul>
<li class="chapter" data-level="" data-path="quality-control.html"><a href="quality-control.html#documentation"><i class="fa fa-check"></i>Documentation</a></li>
<li class="chapter" data-level="" data-path="quality-control.html"><a href="quality-control.html#consistency"><i class="fa fa-check"></i>Consistency</a></li>
<li class="chapter" data-level="" data-path="quality-control.html"><a href="quality-control.html#collaboration"><i class="fa fa-check"></i>Collaboration</a></li>
<li class="chapter" data-level="" data-path="quality-control.html"><a href="quality-control.html#when-in-doubt"><i class="fa fa-check"></i>When in Doubt</a></li>
</ul></li>
<li class="chapter" data-level="2.7" data-path="quality-control.html"><a href="quality-control.html#complete-qc-workflow"><i class="fa fa-check"></i><b>2.7</b> Complete QC Workflow</a></li>
</ul></li>
<li class="chapter" data-level="3" data-path="visualization.html"><a href="visualization.html"><i class="fa fa-check"></i><b>3</b> Visualization</a>
<ul>
<li class="chapter" data-level="3.1" data-path="visualization.html"><a href="visualization.html#why-visualize"><i class="fa fa-check"></i><b>3.1</b> Why Visualize?</a></li>
<li class="chapter" data-level="3.2" data-path="visualization.html"><a href="visualization.html#heatmaps"><i class="fa fa-check"></i><b>3.2</b> Heatmaps</a>
<ul>
<li class="chapter" data-level="3.2.1" data-path="visualization.html"><a href="visualization.html#basic-heatmap"><i class="fa fa-check"></i><b>3.2.1</b> Basic Heatmap</a></li>
<li class="chapter" data-level="3.2.2" data-path="visualization.html"><a href="visualization.html#heatmap-with-annotations"><i class="fa fa-check"></i><b>3.2.2</b> Heatmap with Annotations</a></li>
<li class="chapter" data-level="3.2.3" data-path="visualization.html"><a href="visualization.html#understanding-the-heatmap"><i class="fa fa-check"></i><b>3.2.3</b> Understanding the Heatmap</a></li>
<li class="chapter" data-level="3.2.4" data-path="visualization.html"><a href="visualization.html#interpreting-clusters"><i class="fa fa-check"></i><b>3.2.4</b> Interpreting Clusters</a></li>
</ul></li>
<li class="chapter" data-level="3.3" data-path="visualization.html"><a href="visualization.html#principal-component-analysis-pca"><i class="fa fa-check"></i><b>3.3</b> Principal Component Analysis (PCA)</a>
<ul>
<li class="chapter" data-level="3.3.1" data-path="visualization.html"><a href="visualization.html#pca-with-multiple-visual-encodings"><i class="fa fa-check"></i><b>3.3.1</b> PCA with Multiple Visual Encodings</a></li>
<li class="chapter" data-level="3.3.2" data-path="visualization.html"><a href="visualization.html#understanding-pca-plots"><i class="fa fa-check"></i><b>3.3.2</b> Understanding PCA Plots</a></li>
</ul></li>
<li class="chapter" data-level="3.4" data-path="visualization.html"><a href="visualization.html#custom-visualizations-with-ggplot2"><i class="fa fa-check"></i><b>3.4</b> Custom Visualizations with <code>ggplot2</code></a>
<ul>
<li class="chapter" data-level="3.4.1" data-path="visualization.html"><a href="visualization.html#npq-distribution---histogram"><i class="fa fa-check"></i><b>3.4.1</b> NPQ Distribution - Histogram</a></li>
<li class="chapter" data-level="3.4.2" data-path="visualization.html"><a href="visualization.html#npq-distribution-by-group---density-plot"><i class="fa fa-check"></i><b>3.4.2</b> NPQ Distribution by Group - Density Plot</a></li>
<li class="chapter" data-level="3.4.3" data-path="visualization.html"><a href="visualization.html#single-protein-across-groups"><i class="fa fa-check"></i><b>3.4.3</b> Single Protein Across Groups</a></li>
<li class="chapter" data-level="3.4.4" data-path="visualization.html"><a href="visualization.html#multiple-proteins-across-groups"><i class="fa fa-check"></i><b>3.4.4</b> Multiple Proteins Across Groups</a></li>
<li class="chapter" data-level="3.4.5" data-path="visualization.html"><a href="visualization.html#protein-protein-correlation"><i class="fa fa-check"></i><b>3.4.5</b> Protein-Protein Correlation</a></li>
</ul></li>
<li class="chapter" data-level="3.5" data-path="visualization.html"><a href="visualization.html#saving-plots"><i class="fa fa-check"></i><b>3.5</b> Saving Plots</a>
<ul>
<li class="chapter" data-level="" data-path="visualization.html"><a href="visualization.html#save-heatmap"><i class="fa fa-check"></i>Save Heatmap</a></li>
<li class="chapter" data-level="" data-path="visualization.html"><a href="visualization.html#save-pca"><i class="fa fa-check"></i>Save PCA</a></li>
<li class="chapter" data-level="" data-path="visualization.html"><a href="visualization.html#save-ggplot-objects"><i class="fa fa-check"></i>Save ggplot Objects</a></li>
</ul></li>
<li class="chapter" data-level="3.6" data-path="visualization.html"><a href="visualization.html#visualization-best-practices"><i class="fa fa-check"></i><b>3.6</b> Visualization Best Practices</a></li>
<li class="chapter" data-level="3.7" data-path="visualization.html"><a href="visualization.html#complete-visualization-workflow"><i class="fa fa-check"></i><b>3.7</b> Complete Visualization Workflow</a></li>
</ul></li>
<li class="chapter" data-level="4" data-path="differential-abundance-analysis.html"><a href="differential-abundance-analysis.html"><i class="fa fa-check"></i><b>4</b> Differential Abundance Analysis</a>
<ul>
<li class="chapter" data-level="4.1" data-path="differential-abundance-analysis.html"><a href="differential-abundance-analysis.html#overview"><i class="fa fa-check"></i><b>4.1</b> Overview</a></li>
<li class="chapter" data-level="4.2" data-path="differential-abundance-analysis.html"><a href="differential-abundance-analysis.html#Ch4"><i class="fa fa-check"></i><b>4.2</b> Differential Abundance</a>
<ul>
<li class="chapter" data-level="4.2.1" data-path="differential-abundance-analysis.html"><a href="differential-abundance-analysis.html#group-comparison"><i class="fa fa-check"></i><b>4.2.1</b> Group Comparison</a></li>
<li class="chapter" data-level="4.2.2" data-path="differential-abundance-analysis.html"><a href="differential-abundance-analysis.html#understanding-the-model"><i class="fa fa-check"></i><b>4.2.2</b> Understanding the Model</a></li>
</ul></li>
<li class="chapter" data-level="4.3" data-path="differential-abundance-analysis.html"><a href="differential-abundance-analysis.html#model-results"><i class="fa fa-check"></i><b>4.3</b> Model Results</a>
<ul>
<li class="chapter" data-level="4.3.1" data-path="differential-abundance-analysis.html"><a href="differential-abundance-analysis.html#key-columns-in-results"><i class="fa fa-check"></i><b>4.3.1</b> Key Columns in Results</a></li>
</ul></li>
<li class="chapter" data-level="4.4" data-path="differential-abundance-analysis.html"><a href="differential-abundance-analysis.html#de-targets"><i class="fa fa-check"></i><b>4.4</b> Finding Significant Proteins</a>
<ul>
<li class="chapter" data-level="4.4.1" data-path="differential-abundance-analysis.html"><a href="differential-abundance-analysis.html#filter-by-fdr-threshold"><i class="fa fa-check"></i><b>4.4.1</b> Filter by FDR Threshold</a></li>
<li class="chapter" data-level="4.4.2" data-path="differential-abundance-analysis.html"><a href="differential-abundance-analysis.html#higher-vs-lower-abundance"><i class="fa fa-check"></i><b>4.4.2</b> Higher vs Lower Abundance</a></li>
</ul></li>
<li class="chapter" data-level="4.5" data-path="differential-abundance-analysis.html"><a href="differential-abundance-analysis.html#volcano-plots"><i class="fa fa-check"></i><b>4.5</b> Volcano Plots</a>
<ul>
<li class="chapter" data-level="4.5.1" data-path="differential-abundance-analysis.html"><a href="differential-abundance-analysis.html#inflammatory-disease-vs-normal"><i class="fa fa-check"></i><b>4.5.1</b> Inflammatory Disease vs Normal</a></li>
<li class="chapter" data-level="4.5.2" data-path="differential-abundance-analysis.html"><a href="differential-abundance-analysis.html#understanding-volcano-plots"><i class="fa fa-check"></i><b>4.5.2</b> Understanding Volcano Plots</a></li>
<li class="chapter" data-level="4.5.3" data-path="differential-abundance-analysis.html"><a href="differential-abundance-analysis.html#cancer-vs-normal"><i class="fa fa-check"></i><b>4.5.3</b> Cancer vs Normal</a></li>
<li class="chapter" data-level="4.5.4" data-path="differential-abundance-analysis.html"><a href="differential-abundance-analysis.html#saving-volcano-plots"><i class="fa fa-check"></i><b>4.5.4</b> Saving Volcano Plots</a></li>
</ul></li>
<li class="chapter" data-level="4.6" data-path="differential-abundance-analysis.html"><a href="differential-abundance-analysis.html#visualization-of-significant-targets"><i class="fa fa-check"></i><b>4.6</b> Visualization of Significant Targets</a>
<ul>
<li class="chapter" data-level="4.6.1" data-path="differential-abundance-analysis.html"><a href="differential-abundance-analysis.html#inflammatory-disease-vs-normal-1"><i class="fa fa-check"></i><b>4.6.1</b> Inflammatory Disease vs Normal</a></li>
</ul></li>
<li class="chapter" data-level="4.7" data-path="differential-abundance-analysis.html"><a href="differential-abundance-analysis.html#multiple-disease-groups"><i class="fa fa-check"></i><b>4.7</b> Multiple Disease Groups</a></li>
<li class="chapter" data-level="4.8" data-path="differential-abundance-analysis.html"><a href="differential-abundance-analysis.html#model-considerations"><i class="fa fa-check"></i><b>4.8</b> Model Considerations</a>
<ul>
<li class="chapter" data-level="4.8.1" data-path="differential-abundance-analysis.html"><a href="differential-abundance-analysis.html#reference-level"><i class="fa fa-check"></i><b>4.8.1</b> Reference Level</a></li>
<li class="chapter" data-level="4.8.2" data-path="differential-abundance-analysis.html"><a href="differential-abundance-analysis.html#including-covariates"><i class="fa fa-check"></i><b>4.8.2</b> Including Covariates</a></li>
<li class="chapter" data-level="4.8.3" data-path="differential-abundance-analysis.html"><a href="differential-abundance-analysis.html#model-formula-options"><i class="fa fa-check"></i><b>4.8.3</b> Model Formula Options</a></li>
</ul></li>
<li class="chapter" data-level="4.9" data-path="differential-abundance-analysis.html"><a href="differential-abundance-analysis.html#interpreting-results"><i class="fa fa-check"></i><b>4.9</b> Interpreting Results</a>
<ul>
<li class="chapter" data-level="4.9.1" data-path="differential-abundance-analysis.html"><a href="differential-abundance-analysis.html#effect-size-coefficient"><i class="fa fa-check"></i><b>4.9.1</b> Effect Size (Coefficient)</a></li>
<li class="chapter" data-level="4.9.2" data-path="differential-abundance-analysis.html"><a href="differential-abundance-analysis.html#p-values"><i class="fa fa-check"></i><b>4.9.2</b> P-values</a></li>
<li class="chapter" data-level="4.9.3" data-path="differential-abundance-analysis.html"><a href="differential-abundance-analysis.html#significance-thresholds"><i class="fa fa-check"></i><b>4.9.3</b> Significance Thresholds</a></li>
</ul></li>
<li class="chapter" data-level="4.10" data-path="differential-abundance-analysis.html"><a href="differential-abundance-analysis.html#exporting-results"><i class="fa fa-check"></i><b>4.10</b> Exporting Results</a>
<ul>
<li class="chapter" data-level="4.10.1" data-path="differential-abundance-analysis.html"><a href="differential-abundance-analysis.html#save-results-table"><i class="fa fa-check"></i><b>4.10.1</b> Save Results Table</a></li>
<li class="chapter" data-level="4.10.2" data-path="differential-abundance-analysis.html"><a href="differential-abundance-analysis.html#create-summary-table"><i class="fa fa-check"></i><b>4.10.2</b> Create Summary Table</a></li>
</ul></li>
<li class="chapter" data-level="4.11" data-path="differential-abundance-analysis.html"><a href="differential-abundance-analysis.html#complete-differential-abundance-workflow"><i class="fa fa-check"></i><b>4.11</b> Complete Differential Abundance Workflow</a></li>
<li class="chapter" data-level="4.12" data-path="differential-abundance-analysis.html"><a href="differential-abundance-analysis.html#best-practices"><i class="fa fa-check"></i><b>4.12</b> Best Practices</a></li>
<li class="chapter" data-level="4.13" data-path="differential-abundance-analysis.html"><a href="differential-abundance-analysis.html#common-issues"><i class="fa fa-check"></i><b>4.13</b> Common Issues</a></li>
</ul></li>
<li class="chapter" data-level="5" data-path="longitudinal-analysis.html"><a href="longitudinal-analysis.html"><i class="fa fa-check"></i><b>5</b> Longitudinal Analysis</a>
<ul>
<li class="chapter" data-level="5.1" data-path="longitudinal-analysis.html"><a href="longitudinal-analysis.html#overview-1"><i class="fa fa-check"></i><b>5.1</b> Overview</a>
<ul>
<li class="chapter" data-level="5.1.1" data-path="longitudinal-analysis.html"><a href="longitudinal-analysis.html#load-and-prepare-data"><i class="fa fa-check"></i><b>5.1.1</b> Load and Prepare Data</a></li>
<li class="chapter" data-level="5.1.2" data-path="longitudinal-analysis.html"><a href="longitudinal-analysis.html#create-metadata"><i class="fa fa-check"></i><b>5.1.2</b> Create Metadata</a></li>
<li class="chapter" data-level="5.1.3" data-path="longitudinal-analysis.html"><a href="longitudinal-analysis.html#convert-to-wide-format"><i class="fa fa-check"></i><b>5.1.3</b> Convert to Wide Format</a></li>
<li class="chapter" data-level="5.1.4" data-path="longitudinal-analysis.html"><a href="longitudinal-analysis.html#descriptive-statistics"><i class="fa fa-check"></i><b>5.1.4</b> Descriptive Statistics</a></li>
<li class="chapter" data-level="5.1.5" data-path="longitudinal-analysis.html"><a href="longitudinal-analysis.html#exploratory-visualization"><i class="fa fa-check"></i><b>5.1.5</b> Exploratory Visualization</a></li>
</ul></li>
<li class="chapter" data-level="5.2" data-path="longitudinal-analysis.html"><a href="longitudinal-analysis.html#linear-mixed-effects-model"><i class="fa fa-check"></i><b>5.2</b> Linear Mixed-Effects Model</a>
<ul>
<li class="chapter" data-level="5.2.1" data-path="longitudinal-analysis.html"><a href="longitudinal-analysis.html#group-effect-analysis"><i class="fa fa-check"></i><b>5.2.1</b> Group Effect Analysis</a></li>
<li class="chapter" data-level="5.2.2" data-path="longitudinal-analysis.html"><a href="longitudinal-analysis.html#understanding-the-model-1"><i class="fa fa-check"></i><b>5.2.2</b> Understanding the Model</a></li>
<li class="chapter" data-level="5.2.3" data-path="longitudinal-analysis.html"><a href="longitudinal-analysis.html#model-results-1"><i class="fa fa-check"></i><b>5.2.3</b> Model Results</a></li>
<li class="chapter" data-level="5.2.4" data-path="longitudinal-analysis.html"><a href="longitudinal-analysis.html#likelihood-ratio-test-lrt-statistics"><i class="fa fa-check"></i><b>5.2.4</b> Likelihood Ratio Test (LRT) Statistics</a></li>
<li class="chapter" data-level="5.2.5" data-path="longitudinal-analysis.html"><a href="longitudinal-analysis.html#model-coefficients"><i class="fa fa-check"></i><b>5.2.5</b> Model Coefficients</a></li>
<li class="chapter" data-level="5.2.6" data-path="longitudinal-analysis.html"><a href="longitudinal-analysis.html#overall-group-effect"><i class="fa fa-check"></i><b>5.2.6</b> Overall Group Effect</a></li>
<li class="chapter" data-level="5.2.7" data-path="longitudinal-analysis.html"><a href="longitudinal-analysis.html#specific-time-comparisons"><i class="fa fa-check"></i><b>5.2.7</b> Specific Time Comparisons</a></li>
</ul></li>
<li class="chapter" data-level="5.3" data-path="longitudinal-analysis.html"><a href="longitudinal-analysis.html#volcano-plots-1"><i class="fa fa-check"></i><b>5.3</b> Volcano Plots</a>
<ul>
<li class="chapter" data-level="5.3.1" data-path="longitudinal-analysis.html"><a href="longitudinal-analysis.html#overall-group-effect-lrt"><i class="fa fa-check"></i><b>5.3.1</b> Overall Group Effect (LRT)</a></li>
<li class="chapter" data-level="5.3.2" data-path="longitudinal-analysis.html"><a href="longitudinal-analysis.html#group-specific-comparisons"><i class="fa fa-check"></i><b>5.3.2</b> Group-Specific Comparisons</a></li>
</ul></li>
<li class="chapter" data-level="5.4" data-path="longitudinal-analysis.html"><a href="longitudinal-analysis.html#trajectory-visualization"><i class="fa fa-check"></i><b>5.4</b> Trajectory Visualization</a>
<ul>
<li class="chapter" data-level="5.4.1" data-path="longitudinal-analysis.html"><a href="longitudinal-analysis.html#spaghetti-plot-discrete-time-groups"><i class="fa fa-check"></i><b>5.4.1</b> Spaghetti Plot: Discrete Time Groups</a></li>
<li class="chapter" data-level="5.4.2" data-path="longitudinal-analysis.html"><a href="longitudinal-analysis.html#spaghetti-plot-continuous-time"><i class="fa fa-check"></i><b>5.4.2</b> Spaghetti Plot: Continuous Time</a></li>
</ul></li>
<li class="chapter" data-level="5.5" data-path="longitudinal-analysis.html"><a href="longitudinal-analysis.html#model-considerations-1"><i class="fa fa-check"></i><b>5.5</b> Model Considerations</a>
<ul>
<li class="chapter" data-level="5.5.1" data-path="longitudinal-analysis.html"><a href="longitudinal-analysis.html#random-effects-structure"><i class="fa fa-check"></i><b>5.5.1</b> Random Effects Structure</a></li>
<li class="chapter" data-level="5.5.2" data-path="longitudinal-analysis.html"><a href="longitudinal-analysis.html#fixed-effects-design"><i class="fa fa-check"></i><b>5.5.2</b> Fixed Effects Design</a></li>
<li class="chapter" data-level="5.5.3" data-path="longitudinal-analysis.html"><a href="longitudinal-analysis.html#likelihood-ratio-test"><i class="fa fa-check"></i><b>5.5.3</b> Likelihood Ratio Test</a></li>
</ul></li>
<li class="chapter" data-level="5.6" data-path="longitudinal-analysis.html"><a href="longitudinal-analysis.html#exporting-results-1"><i class="fa fa-check"></i><b>5.6</b> Exporting Results</a>
<ul>
<li class="chapter" data-level="5.6.1" data-path="longitudinal-analysis.html"><a href="longitudinal-analysis.html#save-results-tables"><i class="fa fa-check"></i><b>5.6.1</b> Save Results Tables</a></li>
<li class="chapter" data-level="5.6.2" data-path="longitudinal-analysis.html"><a href="longitudinal-analysis.html#save-plots"><i class="fa fa-check"></i><b>5.6.2</b> Save Plots</a></li>
</ul></li>
<li class="chapter" data-level="5.7" data-path="longitudinal-analysis.html"><a href="longitudinal-analysis.html#complete-longitudinal-analysis-workflow"><i class="fa fa-check"></i><b>5.7</b> Complete Longitudinal Analysis Workflow</a></li>
<li class="chapter" data-level="5.8" data-path="longitudinal-analysis.html"><a href="longitudinal-analysis.html#best-practices-1"><i class="fa fa-check"></i><b>5.8</b> Best Practices</a></li>
<li class="chapter" data-level="5.9" data-path="longitudinal-analysis.html"><a href="longitudinal-analysis.html#common-issues-1"><i class="fa fa-check"></i><b>5.9</b> Common Issues</a></li>
</ul></li>
<li class="chapter" data-level="6" data-path="outcome-modeling.html"><a href="outcome-modeling.html"><i class="fa fa-check"></i><b>6</b> Outcome Modeling</a>
<ul>
<li class="chapter" data-level="6.1" data-path="outcome-modeling.html"><a href="outcome-modeling.html#overview-2"><i class="fa fa-check"></i><b>6.1</b> Overview</a></li>
<li class="chapter" data-level="6.2" data-path="outcome-modeling.html"><a href="outcome-modeling.html#example-1-exploring-age-associations-continuous-outcome"><i class="fa fa-check"></i><b>6.2</b> Example 1: Exploring Age Associations (Continuous Outcome)</a>
<ul>
<li class="chapter" data-level="6.2.1" data-path="outcome-modeling.html"><a href="outcome-modeling.html#why-model-age"><i class="fa fa-check"></i><b>6.2.1</b> Why Model Age?</a></li>
<li class="chapter" data-level="6.2.2" data-path="outcome-modeling.html"><a href="outcome-modeling.html#age-distribution-in-the-dataset"><i class="fa fa-check"></i><b>6.2.2</b> Age Distribution in the Dataset</a></li>
<li class="chapter" data-level="6.2.3" data-path="outcome-modeling.html"><a href="outcome-modeling.html#building-the-age-regression-model"><i class="fa fa-check"></i><b>6.2.3</b> Building the Age Regression Model</a></li>
<li class="chapter" data-level="6.2.4" data-path="outcome-modeling.html"><a href="outcome-modeling.html#understanding-the-age-model"><i class="fa fa-check"></i><b>6.2.4</b> Understanding the Age Model</a></li>
<li class="chapter" data-level="6.2.5" data-path="outcome-modeling.html"><a href="outcome-modeling.html#examining-age-association-results"><i class="fa fa-check"></i><b>6.2.5</b> Examining Age Association Results</a></li>
<li class="chapter" data-level="6.2.6" data-path="outcome-modeling.html"><a href="outcome-modeling.html#finding-age-associated-proteins"><i class="fa fa-check"></i><b>6.2.6</b> Finding Age-Associated Proteins</a></li>
<li class="chapter" data-level="6.2.7" data-path="outcome-modeling.html"><a href="outcome-modeling.html#volcano-plots-2"><i class="fa fa-check"></i><b>6.2.7</b> Volcano Plots</a></li>
<li class="chapter" data-level="6.2.8" data-path="outcome-modeling.html"><a href="outcome-modeling.html#age-associated-proteins-scatterplots"><i class="fa fa-check"></i><b>6.2.8</b> Age-Associated Proteins Scatterplots</a></li>
</ul></li>
<li class="chapter" data-level="6.3" data-path="outcome-modeling.html"><a href="outcome-modeling.html#example-2-modeling-disease-status-binary-outcome"><i class="fa fa-check"></i><b>6.3</b> Example 2: Modeling Disease Status (Binary Outcome)</a>
<ul>
<li class="chapter" data-level="6.3.1" data-path="outcome-modeling.html"><a href="outcome-modeling.html#disease-status-as-binary-outcome"><i class="fa fa-check"></i><b>6.3.1</b> Disease Status as Binary Outcome</a></li>
<li class="chapter" data-level="6.3.2" data-path="outcome-modeling.html"><a href="outcome-modeling.html#preparing-the-disease-data"><i class="fa fa-check"></i><b>6.3.2</b> Preparing the Disease Data</a></li>
<li class="chapter" data-level="6.3.3" data-path="outcome-modeling.html"><a href="outcome-modeling.html#building-the-disease-association-model"><i class="fa fa-check"></i><b>6.3.3</b> Building the Disease Association Model</a></li>
<li class="chapter" data-level="6.3.4" data-path="outcome-modeling.html"><a href="outcome-modeling.html#understanding-the-disease-model"><i class="fa fa-check"></i><b>6.3.4</b> Understanding the Disease Model</a></li>
<li class="chapter" data-level="6.3.5" data-path="outcome-modeling.html"><a href="outcome-modeling.html#examining-disease-association-results"><i class="fa fa-check"></i><b>6.3.5</b> Examining Disease Association Results</a></li>
<li class="chapter" data-level="6.3.6" data-path="outcome-modeling.html"><a href="outcome-modeling.html#finding-disease-associated-proteins"><i class="fa fa-check"></i><b>6.3.6</b> Finding Disease-Associated Proteins</a></li>
<li class="chapter" data-level="6.3.7" data-path="outcome-modeling.html"><a href="outcome-modeling.html#interpreting-odds-ratios"><i class="fa fa-check"></i><b>6.3.7</b> Interpreting Odds Ratios</a></li>
<li class="chapter" data-level="6.3.8" data-path="outcome-modeling.html"><a href="outcome-modeling.html#disease-associated-proteins-volcano-plots"><i class="fa fa-check"></i><b>6.3.8</b> Disease-Associated Proteins Volcano Plots</a></li>
<li class="chapter" data-level="6.3.9" data-path="outcome-modeling.html"><a href="outcome-modeling.html#visualizing-disease-associations"><i class="fa fa-check"></i><b>6.3.9</b> Visualizing Disease Associations</a></li>
<li class="chapter" data-level="6.3.10" data-path="outcome-modeling.html"><a href="outcome-modeling.html#roc-curves-for-disease-associated-proteins"><i class="fa fa-check"></i><b>6.3.10</b> ROC Curves for Disease-Associated Proteins</a></li>
</ul></li>
<li class="chapter" data-level="6.4" data-path="outcome-modeling.html"><a href="outcome-modeling.html#comparing-approaches"><i class="fa fa-check"></i><b>6.4</b> Comparing Approaches</a>
<ul>
<li class="chapter" data-level="6.4.1" data-path="outcome-modeling.html"><a href="outcome-modeling.html#when-to-use-each-function"><i class="fa fa-check"></i><b>6.4.1</b> When to Use Each Function</a></li>
</ul></li>
<li class="chapter" data-level="6.5" data-path="outcome-modeling.html"><a href="outcome-modeling.html#exporting-results-2"><i class="fa fa-check"></i><b>6.5</b> Exporting Results</a></li>
<li class="chapter" data-level="6.6" data-path="outcome-modeling.html"><a href="outcome-modeling.html#complete-outcome-modeling-workflow"><i class="fa fa-check"></i><b>6.6</b> Complete Outcome Modeling Workflow</a></li>
<li class="chapter" data-level="6.7" data-path="outcome-modeling.html"><a href="outcome-modeling.html#best-practices-2"><i class="fa fa-check"></i><b>6.7</b> Best Practices</a>
<ul>
<li class="chapter" data-level="" data-path="outcome-modeling.html"><a href="outcome-modeling.html#model-design"><i class="fa fa-check"></i>Model Design</a></li>
<li class="chapter" data-level="" data-path="outcome-modeling.html"><a href="outcome-modeling.html#interpretation"><i class="fa fa-check"></i>Interpretation</a></li>
<li class="chapter" data-level="" data-path="outcome-modeling.html"><a href="outcome-modeling.html#validation"><i class="fa fa-check"></i>Validation</a></li>
<li class="chapter" data-level="" data-path="outcome-modeling.html"><a href="outcome-modeling.html#reporting"><i class="fa fa-check"></i>Reporting</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="7" data-path="case-study-1.html"><a href="case-study-1.html"><i class="fa fa-check"></i><b>7</b> Case Study: <br> Identifying Proteomic Signatures in Lupus and Rheumatoid Arthritis</a>
<ul>
<li class="chapter" data-level="7.1" data-path="case-study-1.html"><a href="case-study-1.html#overview-3"><i class="fa fa-check"></i><b>7.1</b> Overview</a></li>
<li class="chapter" data-level="7.2" data-path="case-study-1.html"><a href="case-study-1.html#data-preparation"><i class="fa fa-check"></i><b>7.2</b> Data Preparation</a>
<ul>
<li class="chapter" data-level="7.2.1" data-path="case-study-1.html"><a href="case-study-1.html#load-required-libraries"><i class="fa fa-check"></i><b>7.2.1</b> Load Required Libraries</a></li>
<li class="chapter" data-level="7.2.2" data-path="case-study-1.html"><a href="case-study-1.html#import-data"><i class="fa fa-check"></i><b>7.2.2</b> Import Data</a></li>
<li class="chapter" data-level="7.2.3" data-path="case-study-1.html"><a href="case-study-1.html#prepare-sample-metadata"><i class="fa fa-check"></i><b>7.2.3</b> Prepare Sample Metadata</a></li>
</ul></li>
<li class="chapter" data-level="7.3" data-path="case-study-1.html"><a href="case-study-1.html#apply-detectability-threshold"><i class="fa fa-check"></i><b>7.3</b> Apply Detectability Threshold</a></li>
<li class="chapter" data-level="7.4" data-path="case-study-1.html"><a href="case-study-1.html#global-data-visualization"><i class="fa fa-check"></i><b>7.4</b> Global Data Visualization</a>
<ul>
<li class="chapter" data-level="7.4.1" data-path="case-study-1.html"><a href="case-study-1.html#prepare-metadata-for-visualization"><i class="fa fa-check"></i><b>7.4.1</b> Prepare Metadata for Visualization</a></li>
<li class="chapter" data-level="7.4.2" data-path="case-study-1.html"><a href="case-study-1.html#hierarchical-clustering-heatmap"><i class="fa fa-check"></i><b>7.4.2</b> Hierarchical Clustering Heatmap</a></li>
<li class="chapter" data-level="7.4.3" data-path="case-study-1.html"><a href="case-study-1.html#principal-component-analysis"><i class="fa fa-check"></i><b>7.4.3</b> Principal Component Analysis</a></li>
</ul></li>
<li class="chapter" data-level="7.5" data-path="case-study-1.html"><a href="case-study-1.html#statistical-testing"><i class="fa fa-check"></i><b>7.5</b> Statistical Testing</a></li>
<li class="chapter" data-level="7.6" data-path="case-study-1.html"><a href="case-study-1.html#systemic-lupus-erythematosus-sle-analysis"><i class="fa fa-check"></i><b>7.6</b> Systemic Lupus Erythematosus (SLE) Analysis</a>
<ul>
<li class="chapter" data-level="7.6.1" data-path="case-study-1.html"><a href="case-study-1.html#background"><i class="fa fa-check"></i><b>7.6.1</b> Background</a></li>
<li class="chapter" data-level="7.6.2" data-path="case-study-1.html"><a href="case-study-1.html#volcano-plot"><i class="fa fa-check"></i><b>7.6.2</b> Volcano Plot</a></li>
<li class="chapter" data-level="7.6.3" data-path="case-study-1.html"><a href="case-study-1.html#visualizations"><i class="fa fa-check"></i><b>7.6.3</b> Visualizations</a></li>
<li class="chapter" data-level="7.6.4" data-path="case-study-1.html"><a href="case-study-1.html#directional-analysis"><i class="fa fa-check"></i><b>7.6.4</b> Directional Analysis</a></li>
</ul></li>
<li class="chapter" data-level="7.7" data-path="case-study-1.html"><a href="case-study-1.html#rheumatoid-arthritis-ra-analysis"><i class="fa fa-check"></i><b>7.7</b> Rheumatoid Arthritis (RA) Analysis</a>
<ul>
<li class="chapter" data-level="7.7.1" data-path="case-study-1.html"><a href="case-study-1.html#background-1"><i class="fa fa-check"></i><b>7.7.1</b> Background</a></li>
<li class="chapter" data-level="7.7.2" data-path="case-study-1.html"><a href="case-study-1.html#volcano-plot-1"><i class="fa fa-check"></i><b>7.7.2</b> Volcano Plot</a></li>
<li class="chapter" data-level="7.7.3" data-path="case-study-1.html"><a href="case-study-1.html#visualizations-1"><i class="fa fa-check"></i><b>7.7.3</b> Visualizations</a></li>
<li class="chapter" data-level="7.7.4" data-path="case-study-1.html"><a href="case-study-1.html#directional-analysis-1"><i class="fa fa-check"></i><b>7.7.4</b> Directional Analysis</a></li>
</ul></li>
<li class="chapter" data-level="7.8" data-path="case-study-1.html"><a href="case-study-1.html#comparing-disease-signatures"><i class="fa fa-check"></i><b>7.8</b> Comparing Disease Signatures</a>
<ul>
<li class="chapter" data-level="7.8.1" data-path="case-study-1.html"><a href="case-study-1.html#overlap-analysis"><i class="fa fa-check"></i><b>7.8.1</b> Overlap Analysis</a></li>
<li class="chapter" data-level="7.8.2" data-path="case-study-1.html"><a href="case-study-1.html#differential-abundance-summary-table"><i class="fa fa-check"></i><b>7.8.2</b> Differential Abundance Summary Table</a></li>
</ul></li>
<li class="chapter" data-level="7.9" data-path="case-study-1.html"><a href="case-study-1.html#next-steps"><i class="fa fa-check"></i><b>7.9</b> Next Steps</a></li>
<li class="chapter" data-level="7.10" data-path="case-study-1.html"><a href="case-study-1.html#complete-workflow-example-code"><i class="fa fa-check"></i><b>7.10</b> Complete Workflow Example Code</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="additional-resources.html"><a href="additional-resources.html"><i class="fa fa-check"></i>Additional Resources</a>
<ul>
<li class="chapter" data-level="" data-path="additional-resources.html"><a href="additional-resources.html#nulisaseq-resources"><i class="fa fa-check"></i>NULISAseq Resources</a>
<ul>
<li class="chapter" data-level="" data-path="additional-resources.html"><a href="additional-resources.html#package-documentation"><i class="fa fa-check"></i>Package Documentation</a></li>
<li class="chapter" data-level="" data-path="additional-resources.html"><a href="additional-resources.html#github-repository"><i class="fa fa-check"></i>GitHub Repository</a></li>
<li class="chapter" data-level="" data-path="additional-resources.html"><a href="additional-resources.html#support-and-issues"><i class="fa fa-check"></i>Support and Issues</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="additional-resources.html"><a href="additional-resources.html#nulisa-analysis-software-nas"><i class="fa fa-check"></i>NULISA Analysis Software (NAS)</a></li>
<li class="chapter" data-level="" data-path="additional-resources.html"><a href="additional-resources.html#technical-documentation"><i class="fa fa-check"></i>Technical Documentation</a></li>
<li class="chapter" data-level="" data-path="additional-resources.html"><a href="additional-resources.html#r-resources"><i class="fa fa-check"></i>R Programming Resources</a>
<ul>
<li class="chapter" data-level="" data-path="additional-resources.html"><a href="additional-resources.html#r-install"><i class="fa fa-check"></i>Installing R and RStudio</a></li>
<li class="chapter" data-level="" data-path="additional-resources.html"><a href="additional-resources.html#tidyverse-resources"><i class="fa fa-check"></i>Tidyverse Resources</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="additional-resources.html"><a href="additional-resources.html#visualization-resources"><i class="fa fa-check"></i>Data Visualization Resources</a>
<ul>
<li class="chapter" data-level="" data-path="additional-resources.html"><a href="additional-resources.html#ggplot2"><i class="fa fa-check"></i>ggplot2</a></li>
<li class="chapter" data-level="" data-path="additional-resources.html"><a href="additional-resources.html#complexheatmap"><i class="fa fa-check"></i>ComplexHeatmap</a></li>
<li class="chapter" data-level="" data-path="additional-resources.html"><a href="additional-resources.html#pcatools"><i class="fa fa-check"></i>PCAtools</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="additional-resources.html"><a href="additional-resources.html#citations"><i class="fa fa-check"></i>Citing This Book and Packages</a>
<ul>
<li class="chapter" data-level="" data-path="additional-resources.html"><a href="additional-resources.html#citing-this-book"><i class="fa fa-check"></i>Citing This Book</a></li>
<li class="chapter" data-level="" data-path="additional-resources.html"><a href="additional-resources.html#citing-r-and-packages"><i class="fa fa-check"></i>Citing R and Packages</a></li>
<li class="chapter" data-level="" data-path="additional-resources.html"><a href="additional-resources.html#key-citations"><i class="fa fa-check"></i>Key Citations</a></li>
<li class="chapter" data-level="" data-path="additional-resources.html"><a href="additional-resources.html#happy-analyzing"><i class="fa fa-check"></i><strong>Happy analyzing!</strong> 🚀</a></li>
</ul></li>
</ul></li>
<li class="divider"></li>
<li><a href="https://github.com/Alamar-Biosciences/NULISAseqR" target="_blank">GitHub Repository</a></li>
<li><a href="../" target="_blank">NULISAseqR Package</a></li>

</ul>

      </nav>
    </div>

    <div class="book-body">
      <div class="body-inner">
        <div class="book-header" role="navigation">
          <h1>
            <i class="fa fa-circle-o-notch fa-spin"></i><a href="./">NULISAseqR User Guide</a>
          </h1>
        </div>

        <div class="page-wrapper" tabindex="-1" role="main">
          <div class="page-inner">

            <section class="normal" id="section-">
<div id="visualization" class="section level1 hasAnchor" number="3">
<h1><span class="header-section-number">Chapter 3</span> Visualization<a href="visualization.html#visualization" class="anchor-section" aria-label="Anchor link to header"></a></h1>
<p>Visualizing proteomic data helps identify patterns, outliers, and biological signals. This chapter covers the main visualization methods in NULISAseqR.</p>
<div id="why-visualize" class="section level2 hasAnchor" number="3.1">
<h2><span class="header-section-number">3.1</span> Why Visualize?<a href="visualization.html#why-visualize" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>Data visualization helps you:</p>
<ul>
<li>Identify sample clusters and outliers</li>
<li>Assess data quality visually</li>
<li>Detect batch effects</li>
<li>Explore biological patterns</li>
<li>Communicate findings effectively</li>
</ul>
</div>
<div id="heatmaps" class="section level2 hasAnchor" number="3.2">
<h2><span class="header-section-number">3.2</span> Heatmaps<a href="visualization.html#heatmaps" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>Heatmaps show protein expression patterns across samples and targets. Hierarchical clustering can help organize heatmaps to indicate which samples and targets are most similar to each other.</p>
<p>The <code>generate_heatmap()</code> function:</p>
<ul>
<li><strong>Standardizes data</strong> by protein (z-scores): centers and scales each protein’s values</li>
<li><strong>Clusters</strong> similar samples and proteins together</li>
<li><strong>Annotates</strong> samples with metadata (disease type, sex, age, etc.)</li>
<li>Uses <code>ComplexHeatmap</code> with automatic <code>RColorBrewer</code> color palettes</li>
</ul>
<p>See complete function documentation and additional options, use <code>?generate_heatmap()</code>.</p>
<div id="basic-heatmap" class="section level3 hasAnchor" number="3.2.1">
<h3><span class="header-section-number">3.2.1</span> Basic Heatmap<a href="visualization.html#basic-heatmap" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<div class="sourceCode" id="cb82"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb82-1"><a href="visualization.html#cb82-1" tabindex="-1"></a>heatmap1 <span class="ot">&lt;-</span> <span class="fu">generate_heatmap</span>(</span>
<span id="cb82-2"><a href="visualization.html#cb82-2" tabindex="-1"></a>  <span class="at">data =</span> data<span class="sc">$</span>merged<span class="sc">$</span>Data_NPQ,</span>
<span id="cb82-3"><a href="visualization.html#cb82-3" tabindex="-1"></a>  <span class="at">sampleInfo =</span> metadata,</span>
<span id="cb82-4"><a href="visualization.html#cb82-4" tabindex="-1"></a>  <span class="at">sampleName_var =</span> <span class="st">&quot;SampleName&quot;</span>,</span>
<span id="cb82-5"><a href="visualization.html#cb82-5" tabindex="-1"></a>  <span class="at">sample_subset =</span> sample_list,</span>
<span id="cb82-6"><a href="visualization.html#cb82-6" tabindex="-1"></a>  <span class="at">row_fontsize =</span> <span class="dv">4</span></span>
<span id="cb82-7"><a href="visualization.html#cb82-7" tabindex="-1"></a>)</span></code></pre></div>
<p><img src="NULISAseqR-guide_files/figure-html/basic_heatmap-1.png" alt="" width="100%" style="display: block; margin: auto;" /></p>
</div>
<div id="heatmap-with-annotations" class="section level3 hasAnchor" number="3.2.2">
<h3><span class="header-section-number">3.2.2</span> Heatmap with Annotations<a href="visualization.html#heatmap-with-annotations" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>Add sample annotations to highlight key variables:</p>
<div class="sourceCode" id="cb83"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb83-1"><a href="visualization.html#cb83-1" tabindex="-1"></a>heatmap2 <span class="ot">&lt;-</span> <span class="fu">generate_heatmap</span>(</span>
<span id="cb83-2"><a href="visualization.html#cb83-2" tabindex="-1"></a>  <span class="at">data =</span> data<span class="sc">$</span>merged<span class="sc">$</span>Data_NPQ,</span>
<span id="cb83-3"><a href="visualization.html#cb83-3" tabindex="-1"></a>  <span class="at">sampleInfo =</span> metadata,</span>
<span id="cb83-4"><a href="visualization.html#cb83-4" tabindex="-1"></a>  <span class="at">sampleName_var =</span> <span class="st">&quot;SampleName&quot;</span>,</span>
<span id="cb83-5"><a href="visualization.html#cb83-5" tabindex="-1"></a>  <span class="at">sample_subset =</span> sample_list, </span>
<span id="cb83-6"><a href="visualization.html#cb83-6" tabindex="-1"></a>  <span class="at">annotate_sample_by =</span> <span class="fu">c</span>(<span class="st">&quot;disease_type&quot;</span>, <span class="st">&quot;sex&quot;</span>, <span class="st">&quot;age&quot;</span>),</span>
<span id="cb83-7"><a href="visualization.html#cb83-7" tabindex="-1"></a>  <span class="at">row_fontsize =</span> <span class="dv">4</span></span>
<span id="cb83-8"><a href="visualization.html#cb83-8" tabindex="-1"></a>)</span></code></pre></div>
<p><img src="NULISAseqR-guide_files/figure-html/annotated_heatmap-1.png" alt="" width="100%" style="display: block; margin: auto;" /></p>
</div>
<div id="understanding-the-heatmap" class="section level3 hasAnchor" number="3.2.3">
<h3><span class="header-section-number">3.2.3</span> Understanding the Heatmap<a href="visualization.html#understanding-the-heatmap" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>The heatmap shows:</p>
<ul>
<li><strong>Rows</strong>: Protein targets</li>
<li><strong>Columns</strong>: Samples</li>
<li><strong>Colors</strong>: Expression levels (red = high, blue = low)</li>
<li><strong>Dendrograms</strong>: Hierarchical clustering
<ul>
<li>Top: Sample relationships</li>
<li>Left: Protein relationships</li>
</ul></li>
<li><strong>Annotation bars</strong>: Sample characteristics</li>
</ul>
</div>
<div id="interpreting-clusters" class="section level3 hasAnchor" number="3.2.4">
<h3><span class="header-section-number">3.2.4</span> Interpreting Clusters<a href="visualization.html#interpreting-clusters" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>Look for:</p>
<ul>
<li><strong>Sample clusters by biology</strong>: Samples with similar disease states clustering together</li>
<li><strong>Protein clusters</strong>: Co-expressed protein groups</li>
<li><strong>Outlier samples</strong>: Samples far from their expected group</li>
<li><strong>Batch effects</strong>: Clustering by plate/batch rather than biology</li>
</ul>
</div>
</div>
<div id="principal-component-analysis-pca" class="section level2 hasAnchor" number="3.3">
<h2><span class="header-section-number">3.3</span> Principal Component Analysis (PCA)<a href="visualization.html#principal-component-analysis-pca" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>PCA reduces high-dimensional data to its main components of variation.</p>
<p>The <code>generate_pca()</code> function:</p>
<ul>
<li><strong>Standardizes data</strong> by protein (z-scores): centers and scales each protein’s values</li>
<li><strong>Performs PCA</strong> using <code>PCAtools</code> package to identify major sources of variation</li>
<li><strong>Creates biplot</strong> showing sample relationships in PC space</li>
<li><strong>Annotates</strong> samples with metadata colors and shapes</li>
<li>Uses automatic <code>RColorBrewer</code> color palettes or custom colors</li>
</ul>
<p>See complete function documentation and additional options, use <code>?generate_pca()</code>.</p>
<div id="pca-with-multiple-visual-encodings" class="section level3 hasAnchor" number="3.3.1">
<h3><span class="header-section-number">3.3.1</span> PCA with Multiple Visual Encodings<a href="visualization.html#pca-with-multiple-visual-encodings" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>Color by one variable, shape by another:</p>
<div class="sourceCode" id="cb84"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb84-1"><a href="visualization.html#cb84-1" tabindex="-1"></a>pca2 <span class="ot">&lt;-</span> <span class="fu">generate_pca</span>(</span>
<span id="cb84-2"><a href="visualization.html#cb84-2" tabindex="-1"></a>  <span class="at">data =</span> data<span class="sc">$</span>merged<span class="sc">$</span>Data_NPQ,</span>
<span id="cb84-3"><a href="visualization.html#cb84-3" tabindex="-1"></a>  <span class="at">plot_title =</span> <span class="st">&quot;NULISAseq Detectability Study PCA&quot;</span>,</span>
<span id="cb84-4"><a href="visualization.html#cb84-4" tabindex="-1"></a>  <span class="at">sampleInfo =</span> metadata,</span>
<span id="cb84-5"><a href="visualization.html#cb84-5" tabindex="-1"></a>  <span class="at">sampleName_var =</span> <span class="st">&quot;SampleName&quot;</span>,</span>
<span id="cb84-6"><a href="visualization.html#cb84-6" tabindex="-1"></a>  <span class="at">sample_subset =</span> sample_list, </span>
<span id="cb84-7"><a href="visualization.html#cb84-7" tabindex="-1"></a>  <span class="at">annotate_sample_by =</span> <span class="st">&quot;disease_type&quot;</span>,  <span class="co"># Color</span></span>
<span id="cb84-8"><a href="visualization.html#cb84-8" tabindex="-1"></a>  <span class="at">shape_by =</span> <span class="st">&quot;sex&quot;</span>                       <span class="co"># Shape</span></span>
<span id="cb84-9"><a href="visualization.html#cb84-9" tabindex="-1"></a>)</span></code></pre></div>
<p><img src="NULISAseqR-guide_files/figure-html/enhanced_pca-1.png" alt="" width="100%" style="display: block; margin: auto;" /></p>
</div>
<div id="understanding-pca-plots" class="section level3 hasAnchor" number="3.3.2">
<h3><span class="header-section-number">3.3.2</span> Understanding PCA Plots<a href="visualization.html#understanding-pca-plots" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p><strong>Axes</strong></p>
<ul>
<li><strong>PC1 (x-axis)</strong>: Captures the most variation in the data</li>
<li><strong>PC2 (y-axis)</strong>: Captures the second most variation</li>
<li><strong>% variance</strong>: Shows how much variation each PC explains</li>
</ul>
<p><strong>Interpretation</strong></p>
<ul>
<li><strong>Tight clusters</strong>: Samples with similar expression profiles</li>
<li><strong>Separation</strong>: Groups with distinct expression patterns</li>
<li><strong>Outliers</strong>: Samples far from the main cluster</li>
<li><strong>Batch effects</strong>: If clustering by technical variables (plate, batch), indicates unwanted variation</li>
</ul>
<p><strong>What to Look For</strong></p>
<p>Good signs:</p>
<ul>
<li>✓ Samples cluster by biological group</li>
<li>✓ PC1/PC2 explain substantial variance (&gt;20% combined)</li>
<li>✓ Clear separation between conditions</li>
</ul>
<p>Warning signs:</p>
<ul>
<li>✗ Clustering by technical variables (batch, plate)</li>
<li>✗ Outliers far from their group</li>
<li>✗ No visible separation despite known biology</li>
</ul>
</div>
</div>
<div id="custom-visualizations-with-ggplot2" class="section level2 hasAnchor" number="3.4">
<h2><span class="header-section-number">3.4</span> Custom Visualizations with <code>ggplot2</code><a href="visualization.html#custom-visualizations-with-ggplot2" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>For exploratory analysis beyond heatmaps and PCA, create custom plots with <code>ggplot2</code>.</p>
<div class="sourceCode" id="cb85"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb85-1"><a href="visualization.html#cb85-1" tabindex="-1"></a><span class="co"># setting ggplot theme</span></span>
<span id="cb85-2"><a href="visualization.html#cb85-2" tabindex="-1"></a><span class="co"># custom ggplot theme</span></span>
<span id="cb85-3"><a href="visualization.html#cb85-3" tabindex="-1"></a></span>
<span id="cb85-4"><a href="visualization.html#cb85-4" tabindex="-1"></a>custom_theme <span class="ot">&lt;-</span> <span class="fu">theme_bw</span>() <span class="sc">+</span> <span class="fu">theme</span>(</span>
<span id="cb85-5"><a href="visualization.html#cb85-5" tabindex="-1"></a>  <span class="at">panel.background =</span> <span class="fu">element_rect</span>(<span class="at">fill=</span><span class="st">&#39;white&#39;</span>),</span>
<span id="cb85-6"><a href="visualization.html#cb85-6" tabindex="-1"></a>  <span class="at">plot.background =</span> <span class="fu">element_rect</span>(<span class="at">fill=</span><span class="st">&#39;transparent&#39;</span>, <span class="at">color =</span> <span class="cn">NA</span>),</span>
<span id="cb85-7"><a href="visualization.html#cb85-7" tabindex="-1"></a>  <span class="at">legend.background =</span> <span class="fu">element_rect</span>(<span class="at">fill=</span><span class="st">&#39;transparent&#39;</span>),</span>
<span id="cb85-8"><a href="visualization.html#cb85-8" tabindex="-1"></a>  <span class="at">legend.key =</span> <span class="fu">element_rect</span>(<span class="at">fill =</span> <span class="st">&quot;transparent&quot;</span>, <span class="at">color =</span> <span class="cn">NA</span>)</span>
<span id="cb85-9"><a href="visualization.html#cb85-9" tabindex="-1"></a>)</span>
<span id="cb85-10"><a href="visualization.html#cb85-10" tabindex="-1"></a></span>
<span id="cb85-11"><a href="visualization.html#cb85-11" tabindex="-1"></a><span class="fu">theme_set</span>(custom_theme)</span>
<span id="cb85-12"><a href="visualization.html#cb85-12" tabindex="-1"></a></span>
<span id="cb85-13"><a href="visualization.html#cb85-13" tabindex="-1"></a>showtext<span class="sc">::</span><span class="fu">showtext_auto</span>() <span class="do">## able to output beta symbol and other special character in pdf</span></span></code></pre></div>
<div id="npq-distribution---histogram" class="section level3 hasAnchor" number="3.4.1">
<h3><span class="header-section-number">3.4.1</span> NPQ Distribution - Histogram<a href="visualization.html#npq-distribution---histogram" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>Check the overall distribution of NPQ values across all samples and proteins:</p>
<div class="sourceCode" id="cb86"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb86-1"><a href="visualization.html#cb86-1" tabindex="-1"></a>data_long <span class="sc">%&gt;%</span></span>
<span id="cb86-2"><a href="visualization.html#cb86-2" tabindex="-1"></a>  <span class="fu">filter</span>(SampleName <span class="sc">%in%</span> sample_list) <span class="sc">%&gt;%</span></span>
<span id="cb86-3"><a href="visualization.html#cb86-3" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x =</span> NPQ)) <span class="sc">+</span></span>
<span id="cb86-4"><a href="visualization.html#cb86-4" tabindex="-1"></a>  <span class="fu">geom_histogram</span>(<span class="at">bins =</span> <span class="dv">50</span>, <span class="at">fill =</span> <span class="st">&quot;steelblue&quot;</span>, <span class="at">alpha =</span> <span class="fl">0.7</span>) <span class="sc">+</span></span>
<span id="cb86-5"><a href="visualization.html#cb86-5" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">&quot;Distribution of NPQ across all targets&quot;</span>,</span>
<span id="cb86-6"><a href="visualization.html#cb86-6" tabindex="-1"></a>       <span class="at">x =</span> <span class="st">&quot;NPQ&quot;</span>, <span class="at">y =</span> <span class="st">&quot;Count&quot;</span>)</span></code></pre></div>
<p><img src="NULISAseqR-guide_files/figure-html/npq_histogram-1.png" alt="" width="90%" style="display: block; margin: auto;" /></p>
<p>Check the distribution of NPQ values across all samples for each protein:</p>
<div class="sourceCode" id="cb87"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb87-1"><a href="visualization.html#cb87-1" tabindex="-1"></a>data_long <span class="sc">%&gt;%</span></span>
<span id="cb87-2"><a href="visualization.html#cb87-2" tabindex="-1"></a>  <span class="fu">filter</span>(SampleName <span class="sc">%in%</span> sample_list) <span class="sc">%&gt;%</span></span>
<span id="cb87-3"><a href="visualization.html#cb87-3" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x =</span> NPQ)) <span class="sc">+</span></span>
<span id="cb87-4"><a href="visualization.html#cb87-4" tabindex="-1"></a>  <span class="fu">geom_histogram</span>(<span class="at">bins =</span> <span class="dv">50</span>, <span class="at">fill =</span> <span class="st">&quot;steelblue&quot;</span>, <span class="at">alpha =</span> <span class="fl">0.7</span>) <span class="sc">+</span></span>
<span id="cb87-5"><a href="visualization.html#cb87-5" tabindex="-1"></a>  <span class="fu">facet_wrap</span>(<span class="sc">~</span> Target, <span class="at">scales =</span> <span class="st">&quot;free_y&quot;</span>) <span class="sc">+</span></span>
<span id="cb87-6"><a href="visualization.html#cb87-6" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">&quot;Distribution of NPQ Values by Target&quot;</span>,</span>
<span id="cb87-7"><a href="visualization.html#cb87-7" tabindex="-1"></a>       <span class="at">x =</span> <span class="st">&quot;NPQ&quot;</span>, <span class="at">y =</span> <span class="st">&quot;Count&quot;</span>) <span class="sc">+</span></span>
<span id="cb87-8"><a href="visualization.html#cb87-8" tabindex="-1"></a>  <span class="fu">theme</span>(</span>
<span id="cb87-9"><a href="visualization.html#cb87-9" tabindex="-1"></a>    <span class="at">plot.title =</span> <span class="fu">element_text</span>(<span class="at">size =</span> <span class="dv">18</span>, <span class="at">face =</span> <span class="st">&quot;bold&quot;</span>),      </span>
<span id="cb87-10"><a href="visualization.html#cb87-10" tabindex="-1"></a>    <span class="at">plot.subtitle =</span> <span class="fu">element_text</span>(<span class="at">size =</span> <span class="dv">16</span>),                   </span>
<span id="cb87-11"><a href="visualization.html#cb87-11" tabindex="-1"></a>    <span class="at">axis.title.x =</span> <span class="fu">element_text</span>(<span class="at">size =</span> <span class="dv">15</span>),                    </span>
<span id="cb87-12"><a href="visualization.html#cb87-12" tabindex="-1"></a>    <span class="at">axis.title.y =</span> <span class="fu">element_text</span>(<span class="at">size =</span> <span class="dv">15</span>),                    </span>
<span id="cb87-13"><a href="visualization.html#cb87-13" tabindex="-1"></a>    <span class="at">axis.text.x =</span> <span class="fu">element_text</span>(<span class="at">size =</span> <span class="dv">12</span>, <span class="at">angle =</span> <span class="dv">45</span>, <span class="at">hjust =</span> <span class="dv">1</span>), </span>
<span id="cb87-14"><a href="visualization.html#cb87-14" tabindex="-1"></a>    <span class="at">axis.text.y =</span> <span class="fu">element_text</span>(<span class="at">size =</span> <span class="dv">12</span>),                     </span>
<span id="cb87-15"><a href="visualization.html#cb87-15" tabindex="-1"></a>    <span class="at">strip.text =</span> <span class="fu">element_text</span>(<span class="at">size =</span> <span class="dv">11</span>)                    </span>
<span id="cb87-16"><a href="visualization.html#cb87-16" tabindex="-1"></a>  )</span></code></pre></div>
<p><img src="NULISAseqR-guide_files/figure-html/npq_histogram_by_target-1.png" alt="" width="100%" style="display: block; margin: auto;" /></p>
</div>
<div id="npq-distribution-by-group---density-plot" class="section level3 hasAnchor" number="3.4.2">
<h3><span class="header-section-number">3.4.2</span> NPQ Distribution by Group - Density Plot<a href="visualization.html#npq-distribution-by-group---density-plot" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>Compare NPQ distributions between groups to check for systematic differences:</p>
<div class="sourceCode" id="cb88"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb88-1"><a href="visualization.html#cb88-1" tabindex="-1"></a>data_long <span class="sc">%&gt;%</span></span>
<span id="cb88-2"><a href="visualization.html#cb88-2" tabindex="-1"></a>  <span class="fu">filter</span>(SampleName <span class="sc">%in%</span> sample_list) <span class="sc">%&gt;%</span></span>
<span id="cb88-3"><a href="visualization.html#cb88-3" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x =</span> NPQ, <span class="at">fill =</span> disease_type)) <span class="sc">+</span></span>
<span id="cb88-4"><a href="visualization.html#cb88-4" tabindex="-1"></a>  <span class="fu">geom_density</span>(<span class="at">alpha =</span> <span class="fl">0.5</span>) <span class="sc">+</span></span>
<span id="cb88-5"><a href="visualization.html#cb88-5" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">&quot;NPQ Distribution by Disease Type&quot;</span>,</span>
<span id="cb88-6"><a href="visualization.html#cb88-6" tabindex="-1"></a>       <span class="at">x =</span> <span class="st">&quot;NPQ&quot;</span>, <span class="at">y =</span> <span class="st">&quot;Density&quot;</span>,</span>
<span id="cb88-7"><a href="visualization.html#cb88-7" tabindex="-1"></a>       <span class="at">fill =</span> <span class="st">&quot;Disease Type&quot;</span>)</span></code></pre></div>
<p><img src="NULISAseqR-guide_files/figure-html/npq_density-1.png" alt="" width="90%" style="display: block; margin: auto;" /></p>
</div>
<div id="single-protein-across-groups" class="section level3 hasAnchor" number="3.4.3">
<h3><span class="header-section-number">3.4.3</span> Single Protein Across Groups<a href="visualization.html#single-protein-across-groups" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>Examine how a single protein varies across conditions:</p>
<div class="sourceCode" id="cb89"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb89-1"><a href="visualization.html#cb89-1" tabindex="-1"></a><span class="co"># Plot a specific protein across groups</span></span>
<span id="cb89-2"><a href="visualization.html#cb89-2" tabindex="-1"></a>protein_of_interest <span class="ot">&lt;-</span> <span class="st">&quot;IL6&quot;</span></span>
<span id="cb89-3"><a href="visualization.html#cb89-3" tabindex="-1"></a></span>
<span id="cb89-4"><a href="visualization.html#cb89-4" tabindex="-1"></a>data_long <span class="sc">%&gt;%</span></span>
<span id="cb89-5"><a href="visualization.html#cb89-5" tabindex="-1"></a>  <span class="fu">filter</span>(Target <span class="sc">==</span> protein_of_interest, SampleName <span class="sc">%in%</span> sample_list) <span class="sc">%&gt;%</span></span>
<span id="cb89-6"><a href="visualization.html#cb89-6" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x =</span> disease_type, <span class="at">y =</span> NPQ, <span class="at">fill =</span> disease_type)) <span class="sc">+</span></span>
<span id="cb89-7"><a href="visualization.html#cb89-7" tabindex="-1"></a>  <span class="fu">geom_jitter</span>(<span class="at">width =</span> <span class="fl">0.2</span>, <span class="at">alpha =</span> <span class="fl">0.7</span>, <span class="at">size =</span> <span class="dv">1</span>) <span class="sc">+</span></span>
<span id="cb89-8"><a href="visualization.html#cb89-8" tabindex="-1"></a>  <span class="fu">geom_boxplot</span>(<span class="at">alpha =</span> <span class="fl">0.3</span>, <span class="at">outlier.shape =</span> <span class="cn">NA</span>) <span class="sc">+</span></span>
<span id="cb89-9"><a href="visualization.html#cb89-9" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">title =</span> <span class="fu">paste</span>(protein_of_interest, <span class="st">&quot;Expression&quot;</span>),</span>
<span id="cb89-10"><a href="visualization.html#cb89-10" tabindex="-1"></a>       <span class="at">x =</span> <span class="st">&quot;Disease Type&quot;</span>, <span class="at">y =</span> <span class="st">&quot;NPQ&quot;</span>) <span class="sc">+</span></span>
<span id="cb89-11"><a href="visualization.html#cb89-11" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">legend.position =</span> <span class="st">&quot;none&quot;</span>)</span></code></pre></div>
<p><img src="NULISAseqR-guide_files/figure-html/protein_plot-1.png" alt="" width="90%" style="display: block; margin: auto;" /></p>
</div>
<div id="multiple-proteins-across-groups" class="section level3 hasAnchor" number="3.4.4">
<h3><span class="header-section-number">3.4.4</span> Multiple Proteins Across Groups<a href="visualization.html#multiple-proteins-across-groups" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>Compare several proteins simultaneously using facets:</p>
<div class="sourceCode" id="cb90"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb90-1"><a href="visualization.html#cb90-1" tabindex="-1"></a><span class="co"># Select top 6 proteins by variance</span></span>
<span id="cb90-2"><a href="visualization.html#cb90-2" tabindex="-1"></a>protein_variance <span class="ot">&lt;-</span> <span class="fu">apply</span>(data<span class="sc">$</span>merged<span class="sc">$</span>Data_NPQ[, sample_list], <span class="dv">1</span>, var, <span class="at">na.rm =</span> <span class="cn">TRUE</span>)</span>
<span id="cb90-3"><a href="visualization.html#cb90-3" tabindex="-1"></a>top_proteins <span class="ot">&lt;-</span> <span class="fu">names</span>(<span class="fu">sort</span>(protein_variance, <span class="at">decreasing =</span> <span class="cn">TRUE</span>)[<span class="dv">1</span><span class="sc">:</span><span class="dv">6</span>])</span>
<span id="cb90-4"><a href="visualization.html#cb90-4" tabindex="-1"></a></span>
<span id="cb90-5"><a href="visualization.html#cb90-5" tabindex="-1"></a><span class="co"># Plot multiple proteins</span></span>
<span id="cb90-6"><a href="visualization.html#cb90-6" tabindex="-1"></a>data_long <span class="sc">%&gt;%</span> </span>
<span id="cb90-7"><a href="visualization.html#cb90-7" tabindex="-1"></a>  <span class="fu">filter</span>(Target <span class="sc">%in%</span> top_proteins, SampleName <span class="sc">%in%</span> sample_list) <span class="sc">%&gt;%</span></span>
<span id="cb90-8"><a href="visualization.html#cb90-8" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x =</span> disease_type, <span class="at">y =</span> NPQ, <span class="at">fill =</span> disease_type)) <span class="sc">+</span></span>
<span id="cb90-9"><a href="visualization.html#cb90-9" tabindex="-1"></a>  <span class="fu">geom_boxplot</span>(<span class="at">alpha =</span> <span class="fl">0.7</span>, <span class="at">outlier.shape =</span> <span class="cn">NA</span>) <span class="sc">+</span></span>
<span id="cb90-10"><a href="visualization.html#cb90-10" tabindex="-1"></a>  <span class="fu">geom_jitter</span>(<span class="at">width =</span> <span class="fl">0.2</span>, <span class="at">alpha =</span> <span class="fl">0.3</span>, <span class="at">size =</span> <span class="dv">1</span>) <span class="sc">+</span></span>
<span id="cb90-11"><a href="visualization.html#cb90-11" tabindex="-1"></a>  <span class="fu">facet_wrap</span>(<span class="sc">~</span>Target, <span class="at">scales =</span> <span class="st">&quot;free_y&quot;</span>, <span class="at">ncol =</span> <span class="dv">3</span>) <span class="sc">+</span></span>
<span id="cb90-12"><a href="visualization.html#cb90-12" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">&quot;Top Variable Proteins Across Disease Groups&quot;</span>,</span>
<span id="cb90-13"><a href="visualization.html#cb90-13" tabindex="-1"></a>       <span class="at">x =</span> <span class="st">&quot;Disease Type&quot;</span>, <span class="at">y =</span> <span class="st">&quot;NPQ&quot;</span>) <span class="sc">+</span></span>
<span id="cb90-14"><a href="visualization.html#cb90-14" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">legend.position =</span> <span class="st">&quot;none&quot;</span>,</span>
<span id="cb90-15"><a href="visualization.html#cb90-15" tabindex="-1"></a>        <span class="at">axis.text.x =</span> <span class="fu">element_text</span>(<span class="at">angle =</span> <span class="dv">45</span>, <span class="at">hjust =</span> <span class="dv">1</span>),</span>
<span id="cb90-16"><a href="visualization.html#cb90-16" tabindex="-1"></a>        <span class="at">strip.text =</span> <span class="fu">element_text</span>(<span class="at">size =</span> <span class="dv">16</span>, <span class="at">face =</span> <span class="st">&quot;bold&quot;</span>))</span></code></pre></div>
<p><img src="NULISAseqR-guide_files/figure-html/multiple_proteins-1.png" alt="" width="90%" style="display: block; margin: auto;" /></p>
</div>
<div id="protein-protein-correlation" class="section level3 hasAnchor" number="3.4.5">
<h3><span class="header-section-number">3.4.5</span> Protein-Protein Correlation<a href="visualization.html#protein-protein-correlation" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<div class="sourceCode" id="cb91"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb91-1"><a href="visualization.html#cb91-1" tabindex="-1"></a><span class="co"># Select two proteins to compare</span></span>
<span id="cb91-2"><a href="visualization.html#cb91-2" tabindex="-1"></a>protein1 <span class="ot">&lt;-</span> <span class="st">&quot;IL6&quot;</span></span>
<span id="cb91-3"><a href="visualization.html#cb91-3" tabindex="-1"></a>protein2 <span class="ot">&lt;-</span> <span class="st">&quot;TNF&quot;</span></span>
<span id="cb91-4"><a href="visualization.html#cb91-4" tabindex="-1"></a></span>
<span id="cb91-5"><a href="visualization.html#cb91-5" tabindex="-1"></a>plot_data <span class="ot">&lt;-</span> data_long <span class="sc">%&gt;%</span></span>
<span id="cb91-6"><a href="visualization.html#cb91-6" tabindex="-1"></a>  <span class="fu">filter</span>(Target <span class="sc">%in%</span> <span class="fu">c</span>(protein1, protein2), SampleName <span class="sc">%in%</span> sample_list) <span class="sc">%&gt;%</span></span>
<span id="cb91-7"><a href="visualization.html#cb91-7" tabindex="-1"></a>  <span class="fu">select</span>(SampleName, Target, NPQ, disease_type) <span class="sc">%&gt;%</span></span>
<span id="cb91-8"><a href="visualization.html#cb91-8" tabindex="-1"></a>  <span class="fu">pivot_wider</span>(<span class="at">names_from =</span> Target, <span class="at">values_from =</span> NPQ)</span>
<span id="cb91-9"><a href="visualization.html#cb91-9" tabindex="-1"></a></span>
<span id="cb91-10"><a href="visualization.html#cb91-10" tabindex="-1"></a><span class="fu">ggplot</span>(plot_data, <span class="fu">aes</span>(<span class="at">x =</span> .data[[protein1]], <span class="at">y =</span> .data[[protein2]], </span>
<span id="cb91-11"><a href="visualization.html#cb91-11" tabindex="-1"></a>                      <span class="at">color =</span> disease_type)) <span class="sc">+</span></span>
<span id="cb91-12"><a href="visualization.html#cb91-12" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="at">size =</span> <span class="dv">1</span>, <span class="at">alpha =</span> <span class="fl">0.7</span>) <span class="sc">+</span></span>
<span id="cb91-13"><a href="visualization.html#cb91-13" tabindex="-1"></a>  <span class="fu">geom_smooth</span>(<span class="at">method =</span> <span class="st">&quot;lm&quot;</span>, <span class="at">se =</span> <span class="cn">FALSE</span>, <span class="at">color =</span> <span class="st">&quot;black&quot;</span>, <span class="at">linetype =</span> <span class="dv">1</span>) <span class="sc">+</span></span>
<span id="cb91-14"><a href="visualization.html#cb91-14" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">title =</span> <span class="fu">paste</span>(protein1, <span class="st">&quot;vs&quot;</span>, protein2),</span>
<span id="cb91-15"><a href="visualization.html#cb91-15" tabindex="-1"></a>       <span class="at">x =</span> <span class="fu">paste</span>(protein1, <span class="st">&quot;NPQ&quot;</span>),</span>
<span id="cb91-16"><a href="visualization.html#cb91-16" tabindex="-1"></a>       <span class="at">y =</span> <span class="fu">paste</span>(protein2, <span class="st">&quot;NPQ&quot;</span>),</span>
<span id="cb91-17"><a href="visualization.html#cb91-17" tabindex="-1"></a>       <span class="at">color =</span> <span class="st">&quot;Disease Type&quot;</span>)</span></code></pre></div>
<p><img src="NULISAseqR-guide_files/figure-html/correlation_plot-1.png" alt="" width="90%" style="display: block; margin: auto;" /></p>
</div>
</div>
<div id="saving-plots" class="section level2 hasAnchor" number="3.5">
<h2><span class="header-section-number">3.5</span> Saving Plots<a href="visualization.html#saving-plots" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>Both <code>generate_heatmap()</code> and <code>generate_pca()</code> have built-in options to save plots directly.</p>
<div id="save-heatmap" class="section level3 unnumbered hasAnchor">
<h3>Save Heatmap<a href="visualization.html#save-heatmap" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<div class="sourceCode" id="cb92"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb92-1"><a href="visualization.html#cb92-1" tabindex="-1"></a><span class="co"># Automatically saves to file</span></span>
<span id="cb92-2"><a href="visualization.html#cb92-2" tabindex="-1"></a><span class="fu">generate_heatmap</span>(</span>
<span id="cb92-3"><a href="visualization.html#cb92-3" tabindex="-1"></a>  <span class="at">data =</span> data<span class="sc">$</span>merged<span class="sc">$</span>Data_NPQ,</span>
<span id="cb92-4"><a href="visualization.html#cb92-4" tabindex="-1"></a>  <span class="at">sampleInfo =</span> metadata,</span>
<span id="cb92-5"><a href="visualization.html#cb92-5" tabindex="-1"></a>  <span class="at">sampleName_var =</span> <span class="st">&quot;SampleName&quot;</span>,</span>
<span id="cb92-6"><a href="visualization.html#cb92-6" tabindex="-1"></a>  <span class="at">sample_subset =</span> sample_list,</span>
<span id="cb92-7"><a href="visualization.html#cb92-7" tabindex="-1"></a>  <span class="at">annotate_sample_by =</span> <span class="fu">c</span>(<span class="st">&quot;disease_type&quot;</span>, <span class="st">&quot;sex&quot;</span>, <span class="st">&quot;age&quot;</span>),</span>
<span id="cb92-8"><a href="visualization.html#cb92-8" tabindex="-1"></a>  <span class="at">output_dir =</span> <span class="st">&quot;figures&quot;</span>,              <span class="co"># Where to save</span></span>
<span id="cb92-9"><a href="visualization.html#cb92-9" tabindex="-1"></a>  <span class="at">plot_name =</span> <span class="st">&quot;expression_heatmap.pdf&quot;</span>,<span class="co"># Filename (PDF, PNG, JPG, SVG)</span></span>
<span id="cb92-10"><a href="visualization.html#cb92-10" tabindex="-1"></a>  <span class="at">row_fontsize =</span> <span class="dv">5</span>,</span>
<span id="cb92-11"><a href="visualization.html#cb92-11" tabindex="-1"></a>  <span class="at">plot_width =</span> <span class="dv">12</span>,                     <span class="co"># Width in inches</span></span>
<span id="cb92-12"><a href="visualization.html#cb92-12" tabindex="-1"></a>  <span class="at">plot_height =</span> <span class="dv">10</span>                     <span class="co"># Height in inches</span></span>
<span id="cb92-13"><a href="visualization.html#cb92-13" tabindex="-1"></a>)</span></code></pre></div>
<p><strong>Supported formats:</strong> PDF, PNG, JPG, SVG (determined by file extension)</p>
</div>
<div id="save-pca" class="section level3 unnumbered hasAnchor">
<h3>Save PCA<a href="visualization.html#save-pca" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<div class="sourceCode" id="cb93"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb93-1"><a href="visualization.html#cb93-1" tabindex="-1"></a><span class="co"># Automatically saves to file</span></span>
<span id="cb93-2"><a href="visualization.html#cb93-2" tabindex="-1"></a><span class="fu">generate_pca</span>(</span>
<span id="cb93-3"><a href="visualization.html#cb93-3" tabindex="-1"></a>  <span class="at">data =</span> data<span class="sc">$</span>merged<span class="sc">$</span>Data_NPQ,</span>
<span id="cb93-4"><a href="visualization.html#cb93-4" tabindex="-1"></a>  <span class="at">sampleInfo =</span> metadata,</span>
<span id="cb93-5"><a href="visualization.html#cb93-5" tabindex="-1"></a>  <span class="at">sampleName_var =</span> <span class="st">&quot;SampleName&quot;</span>,</span>
<span id="cb93-6"><a href="visualization.html#cb93-6" tabindex="-1"></a>  <span class="at">sample_subset =</span> sample_list,</span>
<span id="cb93-7"><a href="visualization.html#cb93-7" tabindex="-1"></a>  <span class="at">annotate_sample_by =</span> <span class="st">&quot;disease_type&quot;</span>,</span>
<span id="cb93-8"><a href="visualization.html#cb93-8" tabindex="-1"></a>  <span class="at">output_dir =</span> <span class="st">&quot;figures&quot;</span>,              <span class="co"># Where to save</span></span>
<span id="cb93-9"><a href="visualization.html#cb93-9" tabindex="-1"></a>  <span class="at">plot_name =</span> <span class="st">&quot;pca.png&quot;</span>,               <span class="co"># Filename (PDF, PNG, JPG, SVG)</span></span>
<span id="cb93-10"><a href="visualization.html#cb93-10" tabindex="-1"></a>  <span class="at">plot_title =</span> <span class="st">&quot;NULISAseq Detectability Study PCA&quot;</span>,</span>
<span id="cb93-11"><a href="visualization.html#cb93-11" tabindex="-1"></a>  <span class="at">plot_width =</span> <span class="dv">8</span>,                      <span class="co"># Width in inches</span></span>
<span id="cb93-12"><a href="visualization.html#cb93-12" tabindex="-1"></a>  <span class="at">plot_height =</span> <span class="dv">6</span>                      <span class="co"># Height in inches</span></span>
<span id="cb93-13"><a href="visualization.html#cb93-13" tabindex="-1"></a>)</span></code></pre></div>
<p><strong>Supported formats:</strong> PDF, PNG, JPG, SVG (determined by file extension)</p>
</div>
<div id="save-ggplot-objects" class="section level3 unnumbered hasAnchor">
<h3>Save ggplot Objects<a href="visualization.html#save-ggplot-objects" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<div class="sourceCode" id="cb94"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb94-1"><a href="visualization.html#cb94-1" tabindex="-1"></a><span class="co"># Create plot</span></span>
<span id="cb94-2"><a href="visualization.html#cb94-2" tabindex="-1"></a>p <span class="ot">&lt;-</span> data_long <span class="sc">%&gt;%</span></span>
<span id="cb94-3"><a href="visualization.html#cb94-3" tabindex="-1"></a>  <span class="fu">filter</span>(SampleName <span class="sc">%in%</span> sample_list) <span class="sc">%&gt;%</span></span>
<span id="cb94-4"><a href="visualization.html#cb94-4" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x =</span> disease_type, <span class="at">y =</span> NPQ, <span class="at">fill =</span> disease_type)) <span class="sc">+</span></span>
<span id="cb94-5"><a href="visualization.html#cb94-5" tabindex="-1"></a>  <span class="fu">geom_boxplot</span>() </span>
<span id="cb94-6"><a href="visualization.html#cb94-6" tabindex="-1"></a></span>
<span id="cb94-7"><a href="visualization.html#cb94-7" tabindex="-1"></a><span class="co"># Save with ggsave</span></span>
<span id="cb94-8"><a href="visualization.html#cb94-8" tabindex="-1"></a><span class="fu">ggsave</span>(<span class="st">&quot;figures/boxplot.pdf&quot;</span>, p, <span class="at">width =</span> <span class="dv">8</span>, <span class="at">height =</span> <span class="dv">6</span>)</span>
<span id="cb94-9"><a href="visualization.html#cb94-9" tabindex="-1"></a><span class="fu">ggsave</span>(<span class="st">&quot;figures/boxplot.png&quot;</span>, p, <span class="at">width =</span> <span class="dv">8</span>, <span class="at">height =</span> <span class="dv">6</span>, <span class="at">dpi =</span> <span class="dv">300</span>)</span></code></pre></div>
</div>
</div>
<div id="visualization-best-practices" class="section level2 hasAnchor" number="3.6">
<h2><span class="header-section-number">3.6</span> Visualization Best Practices<a href="visualization.html#visualization-best-practices" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p><strong>Design Principles</strong></p>
<ul>
<li>Choose appropriate color schemes (consider color-blind friendly palettes)</li>
<li>Use clear, descriptive titles</li>
<li>Label axes properly with units</li>
<li>Include legends when needed</li>
<li>Choose appropriate plot types for your data</li>
</ul>
<p><strong>Interpretation</strong></p>
<ul>
<li>View plots in context of experimental design</li>
<li>Look for biological signals and technical artifacts</li>
<li>Compare results across multiple visualization methods</li>
<li>Document interesting patterns for follow-up</li>
</ul>
<p><strong>Common Issues</strong></p>
<ul>
<li>✗ Plotting too many groups (hard to distinguish) – consider multi-panel plots</li>
<li>✗ Poor color choices (e.g., red/green for color-blind viewers) – use color-blind friendly palettes</li>
<li>✗ Overplotting (too many points overlapping) – use transparent colors by setting <code>alpha</code> &lt; 1</li>
<li>✗ Missing axis labels or legends – be sure to add these!</li>
</ul>
</div>
<div id="complete-visualization-workflow" class="section level2 hasAnchor" number="3.7">
<h2><span class="header-section-number">3.7</span> Complete Visualization Workflow<a href="visualization.html#complete-visualization-workflow" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<div class="sourceCode" id="cb95"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb95-1"><a href="visualization.html#cb95-1" tabindex="-1"></a><span class="co"># Load libraries</span></span>
<span id="cb95-2"><a href="visualization.html#cb95-2" tabindex="-1"></a><span class="fu">library</span>(NULISAseqR)</span>
<span id="cb95-3"><a href="visualization.html#cb95-3" tabindex="-1"></a><span class="fu">library</span>(tidyverse)</span>
<span id="cb95-4"><a href="visualization.html#cb95-4" tabindex="-1"></a></span>
<span id="cb95-5"><a href="visualization.html#cb95-5" tabindex="-1"></a><span class="co"># Set up output directory</span></span>
<span id="cb95-6"><a href="visualization.html#cb95-6" tabindex="-1"></a>out_dir <span class="ot">&lt;-</span> <span class="st">&quot;figures&quot;</span></span>
<span id="cb95-7"><a href="visualization.html#cb95-7" tabindex="-1"></a><span class="fu">dir.create</span>(out_dir, <span class="at">showWarnings =</span> <span class="cn">FALSE</span>)</span>
<span id="cb95-8"><a href="visualization.html#cb95-8" tabindex="-1"></a></span>
<span id="cb95-9"><a href="visualization.html#cb95-9" tabindex="-1"></a><span class="co"># Filter to samples of interest</span></span>
<span id="cb95-10"><a href="visualization.html#cb95-10" tabindex="-1"></a>sample_list <span class="ot">&lt;-</span> metadata <span class="sc">%&gt;%</span> </span>
<span id="cb95-11"><a href="visualization.html#cb95-11" tabindex="-1"></a>  <span class="fu">filter</span>(SampleMatrix <span class="sc">==</span> <span class="st">&quot;Plasma&quot;</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb95-12"><a href="visualization.html#cb95-12" tabindex="-1"></a>  <span class="fu">pull</span>(SampleName)</span>
<span id="cb95-13"><a href="visualization.html#cb95-13" tabindex="-1"></a></span>
<span id="cb95-14"><a href="visualization.html#cb95-14" tabindex="-1"></a><span class="co"># 1. Generate heatmap with annotations</span></span>
<span id="cb95-15"><a href="visualization.html#cb95-15" tabindex="-1"></a><span class="fu">generate_heatmap</span>(</span>
<span id="cb95-16"><a href="visualization.html#cb95-16" tabindex="-1"></a>  <span class="at">data =</span> data<span class="sc">$</span>merged<span class="sc">$</span>Data_NPQ,</span>
<span id="cb95-17"><a href="visualization.html#cb95-17" tabindex="-1"></a>  <span class="at">output_dir =</span> out_dir,</span>
<span id="cb95-18"><a href="visualization.html#cb95-18" tabindex="-1"></a>  <span class="at">plot_name =</span> <span class="st">&quot;expression_heatmap.pdf&quot;</span>,</span>
<span id="cb95-19"><a href="visualization.html#cb95-19" tabindex="-1"></a>  <span class="at">sampleInfo =</span> metadata,</span>
<span id="cb95-20"><a href="visualization.html#cb95-20" tabindex="-1"></a>  <span class="at">sampleName_var =</span> <span class="st">&quot;SampleName&quot;</span>,</span>
<span id="cb95-21"><a href="visualization.html#cb95-21" tabindex="-1"></a>  <span class="at">sample_subset =</span> sample_list,</span>
<span id="cb95-22"><a href="visualization.html#cb95-22" tabindex="-1"></a>  <span class="at">annotate_sample_by =</span> <span class="fu">c</span>(<span class="st">&quot;disease_type&quot;</span>, <span class="st">&quot;sex&quot;</span>, <span class="st">&quot;age&quot;</span>),</span>
<span id="cb95-23"><a href="visualization.html#cb95-23" tabindex="-1"></a>  <span class="at">row_fontsize =</span> <span class="dv">5</span>,</span>
<span id="cb95-24"><a href="visualization.html#cb95-24" tabindex="-1"></a>  <span class="at">plot_width =</span> <span class="dv">12</span>,</span>
<span id="cb95-25"><a href="visualization.html#cb95-25" tabindex="-1"></a>  <span class="at">plot_height =</span> <span class="dv">10</span></span>
<span id="cb95-26"><a href="visualization.html#cb95-26" tabindex="-1"></a>)</span>
<span id="cb95-27"><a href="visualization.html#cb95-27" tabindex="-1"></a></span>
<span id="cb95-28"><a href="visualization.html#cb95-28" tabindex="-1"></a><span class="co"># 2. Generate PCA plot</span></span>
<span id="cb95-29"><a href="visualization.html#cb95-29" tabindex="-1"></a><span class="fu">generate_pca</span>(</span>
<span id="cb95-30"><a href="visualization.html#cb95-30" tabindex="-1"></a>  <span class="at">data =</span> data<span class="sc">$</span>merged<span class="sc">$</span>Data_NPQ,</span>
<span id="cb95-31"><a href="visualization.html#cb95-31" tabindex="-1"></a>  <span class="at">output_dir =</span> out_dir,</span>
<span id="cb95-32"><a href="visualization.html#cb95-32" tabindex="-1"></a>  <span class="at">plot_name =</span> <span class="st">&quot;pca_plot.pdf&quot;</span>,</span>
<span id="cb95-33"><a href="visualization.html#cb95-33" tabindex="-1"></a>  <span class="at">plot_title =</span> <span class="st">&quot;NULISAseq Detectability Study PCA&quot;</span>,</span>
<span id="cb95-34"><a href="visualization.html#cb95-34" tabindex="-1"></a>  <span class="at">sampleInfo =</span> metadata,</span>
<span id="cb95-35"><a href="visualization.html#cb95-35" tabindex="-1"></a>  <span class="at">sampleName_var =</span> <span class="st">&quot;SampleName&quot;</span>,</span>
<span id="cb95-36"><a href="visualization.html#cb95-36" tabindex="-1"></a>  <span class="at">sample_subset =</span> sample_list,</span>
<span id="cb95-37"><a href="visualization.html#cb95-37" tabindex="-1"></a>  <span class="at">annotate_sample_by =</span> <span class="st">&quot;disease_type&quot;</span>,</span>
<span id="cb95-38"><a href="visualization.html#cb95-38" tabindex="-1"></a>  <span class="at">shape_by =</span> <span class="st">&quot;sex&quot;</span>,</span>
<span id="cb95-39"><a href="visualization.html#cb95-39" tabindex="-1"></a>  <span class="at">plot_width =</span> <span class="dv">8</span>,</span>
<span id="cb95-40"><a href="visualization.html#cb95-40" tabindex="-1"></a>  <span class="at">plot_height =</span> <span class="dv">6</span></span>
<span id="cb95-41"><a href="visualization.html#cb95-41" tabindex="-1"></a>)</span>
<span id="cb95-42"><a href="visualization.html#cb95-42" tabindex="-1"></a></span>
<span id="cb95-43"><a href="visualization.html#cb95-43" tabindex="-1"></a><span class="co"># setting ggplot theme</span></span>
<span id="cb95-44"><a href="visualization.html#cb95-44" tabindex="-1"></a><span class="co"># custom ggplot theme</span></span>
<span id="cb95-45"><a href="visualization.html#cb95-45" tabindex="-1"></a></span>
<span id="cb95-46"><a href="visualization.html#cb95-46" tabindex="-1"></a>custom_theme <span class="ot">&lt;-</span> <span class="fu">theme_bw</span>() <span class="sc">+</span> <span class="fu">theme</span>(</span>
<span id="cb95-47"><a href="visualization.html#cb95-47" tabindex="-1"></a>  <span class="at">panel.background =</span> <span class="fu">element_rect</span>(<span class="at">fill=</span><span class="st">&#39;white&#39;</span>),</span>
<span id="cb95-48"><a href="visualization.html#cb95-48" tabindex="-1"></a>  <span class="at">plot.background =</span> <span class="fu">element_rect</span>(<span class="at">fill=</span><span class="st">&#39;transparent&#39;</span>, <span class="at">color =</span> <span class="cn">NA</span>),</span>
<span id="cb95-49"><a href="visualization.html#cb95-49" tabindex="-1"></a>  <span class="at">legend.background =</span> <span class="fu">element_rect</span>(<span class="at">fill=</span><span class="st">&#39;transparent&#39;</span>),</span>
<span id="cb95-50"><a href="visualization.html#cb95-50" tabindex="-1"></a>  <span class="at">legend.key =</span> <span class="fu">element_rect</span>(<span class="at">fill =</span> <span class="st">&quot;transparent&quot;</span>, <span class="at">color =</span> <span class="cn">NA</span>)</span>
<span id="cb95-51"><a href="visualization.html#cb95-51" tabindex="-1"></a>)</span>
<span id="cb95-52"><a href="visualization.html#cb95-52" tabindex="-1"></a></span>
<span id="cb95-53"><a href="visualization.html#cb95-53" tabindex="-1"></a><span class="fu">theme_set</span>(custom_theme)</span>
<span id="cb95-54"><a href="visualization.html#cb95-54" tabindex="-1"></a></span>
<span id="cb95-55"><a href="visualization.html#cb95-55" tabindex="-1"></a>showtext<span class="sc">::</span><span class="fu">showtext_auto</span>() <span class="do">## able to output beta symbol and other special character in pdf</span></span>
<span id="cb95-56"><a href="visualization.html#cb95-56" tabindex="-1"></a></span>
<span id="cb95-57"><a href="visualization.html#cb95-57" tabindex="-1"></a><span class="co"># 3. NPQ distribution histogram</span></span>
<span id="cb95-58"><a href="visualization.html#cb95-58" tabindex="-1"></a>p_hist <span class="ot">&lt;-</span> data_long <span class="sc">%&gt;%</span></span>
<span id="cb95-59"><a href="visualization.html#cb95-59" tabindex="-1"></a>  <span class="fu">filter</span>(SampleName <span class="sc">%in%</span> sample_list) <span class="sc">%&gt;%</span></span>
<span id="cb95-60"><a href="visualization.html#cb95-60" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x =</span> NPQ)) <span class="sc">+</span></span>
<span id="cb95-61"><a href="visualization.html#cb95-61" tabindex="-1"></a>  <span class="fu">geom_histogram</span>(<span class="at">bins =</span> <span class="dv">50</span>, <span class="at">fill =</span> <span class="st">&quot;steelblue&quot;</span>, <span class="at">alpha =</span> <span class="fl">0.7</span>) <span class="sc">+</span></span>
<span id="cb95-62"><a href="visualization.html#cb95-62" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">&quot;Distribution of NPQ Values&quot;</span>,</span>
<span id="cb95-63"><a href="visualization.html#cb95-63" tabindex="-1"></a>       <span class="at">x =</span> <span class="st">&quot;NPQ&quot;</span>, <span class="at">y =</span> <span class="st">&quot;Count&quot;</span>)</span>
<span id="cb95-64"><a href="visualization.html#cb95-64" tabindex="-1"></a></span>
<span id="cb95-65"><a href="visualization.html#cb95-65" tabindex="-1"></a><span class="fu">ggsave</span>(<span class="fu">file.path</span>(out_dir, <span class="st">&quot;npq_histogram.pdf&quot;</span>), p_hist, </span>
<span id="cb95-66"><a href="visualization.html#cb95-66" tabindex="-1"></a>       <span class="at">width =</span> <span class="dv">7</span>, <span class="at">height =</span> <span class="dv">5</span>)</span>
<span id="cb95-67"><a href="visualization.html#cb95-67" tabindex="-1"></a></span>
<span id="cb95-68"><a href="visualization.html#cb95-68" tabindex="-1"></a><span class="co"># 4. NPQ density by disease type</span></span>
<span id="cb95-69"><a href="visualization.html#cb95-69" tabindex="-1"></a>p_density <span class="ot">&lt;-</span> data_long <span class="sc">%&gt;%</span></span>
<span id="cb95-70"><a href="visualization.html#cb95-70" tabindex="-1"></a>  <span class="fu">filter</span>(SampleName <span class="sc">%in%</span> sample_list) <span class="sc">%&gt;%</span></span>
<span id="cb95-71"><a href="visualization.html#cb95-71" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x =</span> NPQ, <span class="at">fill =</span> disease_type)) <span class="sc">+</span></span>
<span id="cb95-72"><a href="visualization.html#cb95-72" tabindex="-1"></a>  <span class="fu">geom_density</span>(<span class="at">alpha =</span> <span class="fl">0.5</span>) <span class="sc">+</span></span>
<span id="cb95-73"><a href="visualization.html#cb95-73" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">&quot;NPQ Distribution by Disease Type&quot;</span>,</span>
<span id="cb95-74"><a href="visualization.html#cb95-74" tabindex="-1"></a>       <span class="at">x =</span> <span class="st">&quot;NPQ&quot;</span>, <span class="at">y =</span> <span class="st">&quot;Density&quot;</span>,</span>
<span id="cb95-75"><a href="visualization.html#cb95-75" tabindex="-1"></a>       <span class="at">fill =</span> <span class="st">&quot;Disease Type&quot;</span>)</span>
<span id="cb95-76"><a href="visualization.html#cb95-76" tabindex="-1"></a></span>
<span id="cb95-77"><a href="visualization.html#cb95-77" tabindex="-1"></a><span class="fu">ggsave</span>(<span class="fu">file.path</span>(out_dir, <span class="st">&quot;npq_density.pdf&quot;</span>), p_density, </span>
<span id="cb95-78"><a href="visualization.html#cb95-78" tabindex="-1"></a>       <span class="at">width =</span> <span class="dv">8</span>, <span class="at">height =</span> <span class="dv">5</span>)</span>
<span id="cb95-79"><a href="visualization.html#cb95-79" tabindex="-1"></a></span>
<span id="cb95-80"><a href="visualization.html#cb95-80" tabindex="-1"></a><span class="co"># 5. Single protein boxplot</span></span>
<span id="cb95-81"><a href="visualization.html#cb95-81" tabindex="-1"></a>protein_of_interest <span class="ot">&lt;-</span> <span class="st">&quot;IL6&quot;</span></span>
<span id="cb95-82"><a href="visualization.html#cb95-82" tabindex="-1"></a></span>
<span id="cb95-83"><a href="visualization.html#cb95-83" tabindex="-1"></a>p_single <span class="ot">&lt;-</span> data_long <span class="sc">%&gt;%</span></span>
<span id="cb95-84"><a href="visualization.html#cb95-84" tabindex="-1"></a>  <span class="fu">filter</span>(Target <span class="sc">==</span> protein_of_interest, SampleName <span class="sc">%in%</span> sample_list) <span class="sc">%&gt;%</span></span>
<span id="cb95-85"><a href="visualization.html#cb95-85" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x =</span> disease_type, <span class="at">y =</span> NPQ, <span class="at">fill =</span> disease_type)) <span class="sc">+</span></span>
<span id="cb95-86"><a href="visualization.html#cb95-86" tabindex="-1"></a>  <span class="fu">geom_boxplot</span>(<span class="at">alpha =</span> <span class="fl">0.7</span>, <span class="at">outlier.shape =</span> <span class="cn">NA</span>) <span class="sc">+</span></span>
<span id="cb95-87"><a href="visualization.html#cb95-87" tabindex="-1"></a>  <span class="fu">geom_jitter</span>(<span class="at">width =</span> <span class="fl">0.2</span>, <span class="at">alpha =</span> <span class="fl">0.6</span>, <span class="at">size =</span> <span class="dv">2</span>) <span class="sc">+</span></span>
<span id="cb95-88"><a href="visualization.html#cb95-88" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">title =</span> <span class="fu">paste</span>(protein_of_interest, <span class="st">&quot;Expression Across Groups&quot;</span>),</span>
<span id="cb95-89"><a href="visualization.html#cb95-89" tabindex="-1"></a>       <span class="at">x =</span> <span class="st">&quot;Disease Type&quot;</span>, <span class="at">y =</span> <span class="st">&quot;NPQ&quot;</span>) <span class="sc">+</span></span>
<span id="cb95-90"><a href="visualization.html#cb95-90" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">legend.position =</span> <span class="st">&quot;none&quot;</span>,</span>
<span id="cb95-91"><a href="visualization.html#cb95-91" tabindex="-1"></a>        <span class="at">axis.text.x =</span> <span class="fu">element_text</span>(<span class="at">angle =</span> <span class="dv">45</span>, <span class="at">hjust =</span> <span class="dv">1</span>))</span>
<span id="cb95-92"><a href="visualization.html#cb95-92" tabindex="-1"></a></span>
<span id="cb95-93"><a href="visualization.html#cb95-93" tabindex="-1"></a><span class="fu">ggsave</span>(<span class="fu">file.path</span>(out_dir, <span class="fu">paste0</span>(protein_of_interest, <span class="st">&quot;_boxplot.pdf&quot;</span>)), </span>
<span id="cb95-94"><a href="visualization.html#cb95-94" tabindex="-1"></a>       p_single, <span class="at">width =</span> <span class="dv">7</span>, <span class="at">height =</span> <span class="dv">5</span>)</span>
<span id="cb95-95"><a href="visualization.html#cb95-95" tabindex="-1"></a></span>
<span id="cb95-96"><a href="visualization.html#cb95-96" tabindex="-1"></a><span class="co"># 6. Multiple proteins facet plot</span></span>
<span id="cb95-97"><a href="visualization.html#cb95-97" tabindex="-1"></a>protein_variance <span class="ot">&lt;-</span> <span class="fu">apply</span>(data<span class="sc">$</span>merged<span class="sc">$</span>Data_NPQ[, sample_list], <span class="dv">1</span>, </span>
<span id="cb95-98"><a href="visualization.html#cb95-98" tabindex="-1"></a>                          var, <span class="at">na.rm =</span> <span class="cn">TRUE</span>)</span>
<span id="cb95-99"><a href="visualization.html#cb95-99" tabindex="-1"></a>top_proteins <span class="ot">&lt;-</span> <span class="fu">names</span>(<span class="fu">sort</span>(protein_variance, <span class="at">decreasing =</span> <span class="cn">TRUE</span>)[<span class="dv">1</span><span class="sc">:</span><span class="dv">6</span>])</span>
<span id="cb95-100"><a href="visualization.html#cb95-100" tabindex="-1"></a></span>
<span id="cb95-101"><a href="visualization.html#cb95-101" tabindex="-1"></a>p_multi <span class="ot">&lt;-</span> data_long <span class="sc">%&gt;%</span> </span>
<span id="cb95-102"><a href="visualization.html#cb95-102" tabindex="-1"></a>  <span class="fu">filter</span>(Target <span class="sc">%in%</span> top_proteins, SampleName <span class="sc">%in%</span> sample_list) <span class="sc">%&gt;%</span></span>
<span id="cb95-103"><a href="visualization.html#cb95-103" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x =</span> disease_type, <span class="at">y =</span> NPQ, <span class="at">fill =</span> disease_type)) <span class="sc">+</span></span>
<span id="cb95-104"><a href="visualization.html#cb95-104" tabindex="-1"></a>  <span class="fu">geom_boxplot</span>(<span class="at">alpha =</span> <span class="fl">0.7</span>, <span class="at">outlier.shape =</span> <span class="cn">NA</span>) <span class="sc">+</span></span>
<span id="cb95-105"><a href="visualization.html#cb95-105" tabindex="-1"></a>  <span class="fu">geom_jitter</span>(<span class="at">width =</span> <span class="fl">0.2</span>, <span class="at">alpha =</span> <span class="fl">0.3</span>, <span class="at">size =</span> <span class="dv">1</span>) <span class="sc">+</span></span>
<span id="cb95-106"><a href="visualization.html#cb95-106" tabindex="-1"></a>  <span class="fu">facet_wrap</span>(<span class="sc">~</span>Target, <span class="at">scales =</span> <span class="st">&quot;free_y&quot;</span>, <span class="at">ncol =</span> <span class="dv">3</span>) <span class="sc">+</span></span>
<span id="cb95-107"><a href="visualization.html#cb95-107" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">&quot;Top Variable Proteins Across Disease Groups&quot;</span>,</span>
<span id="cb95-108"><a href="visualization.html#cb95-108" tabindex="-1"></a>       <span class="at">x =</span> <span class="st">&quot;Disease Type&quot;</span>, <span class="at">y =</span> <span class="st">&quot;NPQ&quot;</span>) <span class="sc">+</span></span>
<span id="cb95-109"><a href="visualization.html#cb95-109" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">legend.position =</span> <span class="st">&quot;none&quot;</span>,</span>
<span id="cb95-110"><a href="visualization.html#cb95-110" tabindex="-1"></a>        <span class="at">axis.text.x =</span> <span class="fu">element_text</span>(<span class="at">angle =</span> <span class="dv">45</span>, <span class="at">hjust =</span> <span class="dv">1</span>),</span>
<span id="cb95-111"><a href="visualization.html#cb95-111" tabindex="-1"></a>        <span class="at">strip.text =</span> <span class="fu">element_text</span>(<span class="at">size =</span> <span class="dv">12</span>, <span class="at">face =</span> <span class="st">&quot;bold&quot;</span>))</span>
<span id="cb95-112"><a href="visualization.html#cb95-112" tabindex="-1"></a></span>
<span id="cb95-113"><a href="visualization.html#cb95-113" tabindex="-1"></a><span class="fu">ggsave</span>(<span class="fu">file.path</span>(out_dir, <span class="st">&quot;top_proteins_facet.pdf&quot;</span>), p_multi, </span>
<span id="cb95-114"><a href="visualization.html#cb95-114" tabindex="-1"></a>       <span class="at">width =</span> <span class="dv">10</span>, <span class="at">height =</span> <span class="dv">8</span>)</span>
<span id="cb95-115"><a href="visualization.html#cb95-115" tabindex="-1"></a></span>
<span id="cb95-116"><a href="visualization.html#cb95-116" tabindex="-1"></a><span class="co"># 7. Protein correlation plot</span></span>
<span id="cb95-117"><a href="visualization.html#cb95-117" tabindex="-1"></a>protein1 <span class="ot">&lt;-</span> <span class="st">&quot;IL6&quot;</span></span>
<span id="cb95-118"><a href="visualization.html#cb95-118" tabindex="-1"></a>protein2 <span class="ot">&lt;-</span> <span class="st">&quot;TNF&quot;</span></span>
<span id="cb95-119"><a href="visualization.html#cb95-119" tabindex="-1"></a></span>
<span id="cb95-120"><a href="visualization.html#cb95-120" tabindex="-1"></a>plot_data <span class="ot">&lt;-</span> data_long <span class="sc">%&gt;%</span></span>
<span id="cb95-121"><a href="visualization.html#cb95-121" tabindex="-1"></a>  <span class="fu">filter</span>(Target <span class="sc">%in%</span> <span class="fu">c</span>(protein1, protein2), SampleName <span class="sc">%in%</span> sample_list) <span class="sc">%&gt;%</span></span>
<span id="cb95-122"><a href="visualization.html#cb95-122" tabindex="-1"></a>  <span class="fu">select</span>(SampleName, Target, NPQ, disease_type) <span class="sc">%&gt;%</span></span>
<span id="cb95-123"><a href="visualization.html#cb95-123" tabindex="-1"></a>  <span class="fu">pivot_wider</span>(<span class="at">names_from =</span> Target, <span class="at">values_from =</span> NPQ) <span class="sc">%&gt;%</span></span>
<span id="cb95-124"><a href="visualization.html#cb95-124" tabindex="-1"></a>  <span class="fu">na.omit</span>()</span>
<span id="cb95-125"><a href="visualization.html#cb95-125" tabindex="-1"></a></span>
<span id="cb95-126"><a href="visualization.html#cb95-126" tabindex="-1"></a>p_corr <span class="ot">&lt;-</span> <span class="fu">ggplot</span>(plot_data, </span>
<span id="cb95-127"><a href="visualization.html#cb95-127" tabindex="-1"></a>                 <span class="fu">aes</span>(<span class="at">x =</span> .data[[protein1]], <span class="at">y =</span> .data[[protein2]], </span>
<span id="cb95-128"><a href="visualization.html#cb95-128" tabindex="-1"></a>                     <span class="at">color =</span> disease_type)) <span class="sc">+</span></span>
<span id="cb95-129"><a href="visualization.html#cb95-129" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="at">size =</span> <span class="dv">3</span>, <span class="at">alpha =</span> <span class="fl">0.7</span>) <span class="sc">+</span></span>
<span id="cb95-130"><a href="visualization.html#cb95-130" tabindex="-1"></a>  <span class="fu">geom_smooth</span>(<span class="at">method =</span> <span class="st">&quot;lm&quot;</span>, <span class="at">se =</span> <span class="cn">TRUE</span>, <span class="at">color =</span> <span class="st">&quot;black&quot;</span>, </span>
<span id="cb95-131"><a href="visualization.html#cb95-131" tabindex="-1"></a>              <span class="at">linetype =</span> <span class="st">&quot;dashed&quot;</span>, <span class="at">linewidth =</span> <span class="fl">0.5</span>) <span class="sc">+</span></span>
<span id="cb95-132"><a href="visualization.html#cb95-132" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">title =</span> <span class="fu">paste</span>(protein1, <span class="st">&quot;vs&quot;</span>, protein2),</span>
<span id="cb95-133"><a href="visualization.html#cb95-133" tabindex="-1"></a>       <span class="at">x =</span> <span class="fu">paste</span>(protein1, <span class="st">&quot;NPQ&quot;</span>),</span>
<span id="cb95-134"><a href="visualization.html#cb95-134" tabindex="-1"></a>       <span class="at">y =</span> <span class="fu">paste</span>(protein2, <span class="st">&quot;NPQ&quot;</span>),</span>
<span id="cb95-135"><a href="visualization.html#cb95-135" tabindex="-1"></a>       <span class="at">color =</span> <span class="st">&quot;Disease Type&quot;</span>)</span>
<span id="cb95-136"><a href="visualization.html#cb95-136" tabindex="-1"></a></span>
<span id="cb95-137"><a href="visualization.html#cb95-137" tabindex="-1"></a><span class="fu">ggsave</span>(<span class="fu">file.path</span>(out_dir, <span class="st">&quot;protein_correlation.pdf&quot;</span>), p_corr, </span>
<span id="cb95-138"><a href="visualization.html#cb95-138" tabindex="-1"></a>       <span class="at">width =</span> <span class="dv">7</span>, <span class="at">height =</span> <span class="dv">6</span>)</span>
<span id="cb95-139"><a href="visualization.html#cb95-139" tabindex="-1"></a></span>
<span id="cb95-140"><a href="visualization.html#cb95-140" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">&quot;</span><span class="sc">\n</span><span class="st">✓ All visualizations saved to:&quot;</span>, out_dir, <span class="st">&quot;</span><span class="sc">\n</span><span class="st">&quot;</span>)</span>
<span id="cb95-141"><a href="visualization.html#cb95-141" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">&quot;</span><span class="sc">\n</span><span class="st">Generated files:</span><span class="sc">\n</span><span class="st">&quot;</span>)</span>
<span id="cb95-142"><a href="visualization.html#cb95-142" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">&quot;  - expression_heatmap.pdf</span><span class="sc">\n</span><span class="st">&quot;</span>)</span>
<span id="cb95-143"><a href="visualization.html#cb95-143" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">&quot;  - pca_plot.pdf</span><span class="sc">\n</span><span class="st">&quot;</span>)</span>
<span id="cb95-144"><a href="visualization.html#cb95-144" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">&quot;  - npq_histogram.pdf</span><span class="sc">\n</span><span class="st">&quot;</span>)</span>
<span id="cb95-145"><a href="visualization.html#cb95-145" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">&quot;  - npq_density.pdf</span><span class="sc">\n</span><span class="st">&quot;</span>)</span>
<span id="cb95-146"><a href="visualization.html#cb95-146" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">&quot;  - IL6_boxplot.pdf</span><span class="sc">\n</span><span class="st">&quot;</span>)</span>
<span id="cb95-147"><a href="visualization.html#cb95-147" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">&quot;  - top_proteins_facet.pdf</span><span class="sc">\n</span><span class="st">&quot;</span>)</span>
<span id="cb95-148"><a href="visualization.html#cb95-148" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">&quot;  - protein_correlation.pdf</span><span class="sc">\n</span><span class="st">&quot;</span>)</span></code></pre></div>
<p><br>
<strong>Continue to:</strong> <a href="differential-abundance-analysis.html#differential-abundance-analysis">Chapter 4: Differential Abundance Analysis</a></p>

</div>
</div>
            </section>

          </div>
        </div>
      </div>
<a href="quality-control.html" class="navigation navigation-prev " aria-label="Previous page"><i class="fa fa-angle-left"></i></a>
<a href="differential-abundance-analysis.html" class="navigation navigation-next " aria-label="Next page"><i class="fa fa-angle-right"></i></a>
    </div>
  </div>
<script src="libs/gitbook-2.6.7/js/app.min.js"></script>
<script src="libs/gitbook-2.6.7/js/clipboard.min.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-search.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-sharing.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-fontsettings.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-bookdown.js"></script>
<script src="libs/gitbook-2.6.7/js/jquery.highlight.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-clipboard.js"></script>
<script>
gitbook.require(["gitbook"], function(gitbook) {
gitbook.start({
  "sharing": {
    "github": false,
    "facebook": false,
    "twitter": false,
    "linkedin": false,
    "weibo": false,
    "instapaper": false,
    "vk": false,
    "whatsapp": false,
    "all": {},
    "google": false
  },
  "fontsettings": {
    "theme": "white",
    "family": "sans",
    "size": 2
  },
  "edit": {
    "link": null,
    "text": null
  },
  "history": {
    "link": null,
    "text": null
  },
  "view": {
    "link": null,
    "text": null
  },
  "download": null,
  "search": {
    "engine": "fuse",
    "options": null
  },
  "toc": {
    "collapse": "section",
    "scroll_highlight": true
  },
  "toolbar": {
    "position": "fixed"
  }
});
});
</script>

<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    var src = "true";
    if (src === "" || src === "true") src = "https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.9/latest.js?config=TeX-MML-AM_CHTML";
    if (location.protocol !== "file:")
      if (/^https?:/.test(src))
        src = src.replace(/^https?:/, '');
    script.src = src;
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>
</body>

</html>
